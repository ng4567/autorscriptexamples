Package`stocks'
August31,2018
Type
Package
Title
StockMarketAnalysis
Version
1.1.4
License
GPL-3
Date
2018-08-30
Author
DaneR.VanDomelen
Maintainer
DaneR.VanDomelen
<vandomed@gmail.com>
Description
Functionsforanalyzingstocksorotherinvestments.Mainfeaturesareloadingandalign-
inghistoricaldatafortickersymbols,calculatingperformancemetricsforindivid-
ualfundsorportfolios(e.g.annualizedgrowth,maximumdrawdown,Sharpe/Sortinora-
tio),andcreatinggraphs.C++codeisusedtoimproveprocessingspeedwherepossible.
Depends
rbenchmark,quantmod
Imports
dvmisc,graphics,grDevices,Hmisc,lubridate,methods,
RColorBrewer,Rcpp(>=0.12.15),stats,TTR,zoo
Suggests
knitr,rmarkdown,pander,printr
LinkingTo
Rcpp
RoxygenNote
6.0.1
NeedsCompilation
yes
Repository
CRAN
Date/Publication
2018-08-3104:30:03UTC
R
topicsdocumented:
beta_trailing50.......................................
3
contango_hedged......................................
4
contango_simple......................................
5
convert_gain.........................................
7
daily_yearly.........................................
8
diffs.............................................
8
gains_graph.........................................
9
gains_prices.........................................
10
1
2
R
topicsdocumented:
gains_rate..........................................
11
growth_graph........................................
12
highyield_etfs........................................
13
largest_etfs.........................................
14
load_gains..........................................
14
load_prices.........................................
15
mdd.............................................
17
metrics............................................
18
onemetric_graph......................................
19
onemetric_overtime_graph.................................
20
pchanges..........................................
22
pdiffs............................................
23
prices_gains.........................................
23
prices_rate..........................................
24
ratios............................................
25
rrr..............................................
26
sector_spdr_etfs.......................................
27
sharpe............................................
27
sortino............................................
28
stocks............................................
28
targetall...........................................
29
targetbeta_twofunds.....................................
30
threefunds_graph......................................
33
ticker_dates.........................................
35
twofunds_graph.......................................
36
twometrics_graph......................................
39
vanguard_balanced_funds.................................
40
vanguard_bond_etfs.....................................
41
vanguard_bond_funds....................................
41
vanguard_etfs........................................
41
vanguard_funds.......................................
41
vanguard_igrade_etfs....................................
42
vanguard_igrade_funds...................................
42
vanguard_international_etfs.................................
42
vanguard_international_funds...............................
43
vanguard_largecap_etfs...................................
43
vanguard_largecap_funds..................................
43
vanguard_midcap_etfs...................................
44
vanguard_midcap_funds..................................
44
vanguard_sector_etfs....................................
44
vanguard_sector_funds...................................
44
vanguard_smallcap_etfs...................................
45
vanguard_smallcap_funds.................................
45
vanguard_stock_etfs....................................
45
vanguard_stock_funds...................................
46
vanguard_targetdate_funds.................................
46
vanguard_targetrisk_funds.................................
46
vanguard_taxexempt_bond_funds.............................
47
beta_trailing50
3
vanguard_traditional_funds.................................
47
vanguard_treasury_etfs...................................
47
vanguard_treasury_funds..................................
48
Index
49
beta_trailing50
BetaforLast50DailyGains
Description
Calculatesbetaforatickersymbolbasedontheprevious50dailygains.
Usage
beta_trailing50(ticker,bench="SPY",...)
Arguments
ticker
CharacterstringwithtickersymbolsthatYahoo!Financerecognizes.
bench
Characterstringwithtickersymbolforbenchmark.
...
Argumentstopassto
load_gains
.
Value
Numericvalue.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#CalculateTLT
'
sbetabasedontheprevious50dailygains
beta_trailing50("TLT")
##End(Notrun)
4
contango_hedged
contango_hedged
BacktestaHedgedContango-BasedVolatilityTradingStrategy
Description
Implementsthefollowingstrategy:Eachday,holdXIV/SPXU(weightedforzerobeta)ifcontango
>
xiv.spxu.cutpoint
,holdVXX/UPRO(weightedforzerobeta)ifcontango<
vxx.upro.cutpoint
,
andholdcashotherwise.PerhapsnotveryusefulsinceXIVclosedonFeb.20,2018.
Usage
contango_hedged(contango,xiv.spxu.gains=NULL,vxx.upro.gains=NULL,
xiv.spxu.cutpoint=6.36,vxx.upro.cutpoint=5.45,
xiv.allocation=0.46,vxx.allocation=0.46,xiv.beta=NULL,
vxx.beta=NULL,initial=10000)
Arguments
contango
Numericvectorofcontangovaluesattheendofeachtradingday.
xiv.spxu.gains
2-columnnumericmatrixwithgainsforXIVandSPXU.Shouldhavethesame
numberofrowsas
contango
andbedate-shiftedonevaluetotheright.For
example,therowshouldhavetheXIVandSPXUgainsforthedayAFTER
thecontangovalue.
vxx.upro.gains
2-columnnumericmatrixwithgainsforVXXandUPRO.Shouldhavethesame
numberofrowsas
contango
andbedate-shiftedonevaluetotheright.For
example,therowshouldhavetheVXXandUPROgainsforthedayAFTER
thecontangovalue.
xiv.spxu.cutpoint
NumericvaluegivingthecontangocutpointforXIV/SPXUposition.Forexam-
ple,if
xiv.spxu.cutpoint=5
,XIV/SPXUwillbeheldwhenevercontango
isgreaterthan5%.
vxx.upro.cutpoint
NumericvaluegivingthecontangocutpointforVXX/UPROposition.Forex-
ample,if
vxx.upro.cutpoint=-5
,VXX/UPROwillbeheldwhenevercon-
tangoislessthan-5%.
xiv.allocation
NumericvaluespecifyingXIVallocationforXIV/SPXUposition.Forexample,
ifsetto0.46,46%isallocatedtoXIVand54%toSPXUwhencontango>
xiv.spxu.cutpoint
.
vxx.allocation
NumericvaluespecifyingVXXallocationforVXX/UPROposition.Forexam-
ple,ifsetto0.46,46%isallocatedtoVXXand54%toUPROwhencontango
<
vxx.upro.cutpoint
.
xiv.beta
NumericvaluespecifyingXIV'sbeta.Ifspecithefunctionoutwhat
xiv.allocation
needstobeforzero-betaXIV/SPXUpositions.Forexample,
ifsetto3.5,then46.2%XIV/53.8%SPXUachieveszerobeta.
contango_simple
5
vxx.beta
NumericvalueindicatingVXX'sbeta.Ifthefunctionoutwhat
vxx.allocation
needstobeforzero-betaVXX/UPROpositions.Forexample,
ifsetto-3.5,then46.2%VXX/53.8%UPROachieveszerobeta.
initial
Numericvaluegivingtheinitialvalueoftheportfolio.
Details
YoucanhistoricalcontangovaluesfromTheIntelligentInvestorBlog.Youcanclickthe
linkat
http://investing.kuchita.com/2012/06/28/xiv-data-and-pricing-model-since-vix-futures-available-2004/
todownloadazipcontaininganExcelspreadsheet.Then,youwillneedtocalculatewhatever
versionof"contango"youprefer.Itypicallycontangoaswhatpercenthigherthesecond-
monthVIXfuturesareacomparedtothefutures,i.e.dividingthe"2ndmth"columnby
the"1stmth"column,subtracting1,andthenmultiplyingby100.
ToloaddailygainsforXIV,SPXU,VXX,andUPRO,youcanuse
load_gains
,whichusesthe
quantmod
packagetoloaddatafromYahoo!Finance.Youwillhavetospecifythe
from
and
to
inputstomatchthedaterangeforyourcontangovalues.
Value
Listcontaining:
1.
Charactervectornamed
holdings
indicatingwhatfundwasheldeachday(XIV/SPXU,
VXX/UPRO,orcash).
2.
Numericvectornamed
port.gains
givingtheportfoliogainforeachday,whichwillbe0for
daysthatcashwasheldandtheweightedXIV/SPXUorVXX/UPROgainfordaysthatone
ofthosepositionswasheld.
3.
Numericvectornamed
port.balances
givingtheportfoliobalanceeachday.
4.
Numericvaluenamed
trades
givingthetotalnumberoftradesexecuted.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
contango_simple
BacktestaSimpleContango-BasedVolatilityTradingStrategy
Description
Simplestrategy:Eachday,holdXIVifcontango>
xiv.cutpoint
,holdVXXifcontango<
vxx.cutpoint
,andholdcashotherwise.PerhapsnotveryusefulsinceXIVclosedonFeb.20,
2018.
Usage
contango_simple(contango,xiv.gains=NULL,vxx.gains=NULL,
xiv.cutpoint=0,vxx.cutpoint=-Inf,initial=10000)
6
contango_simple
Arguments
contango
Numericvectorofcontangovaluesattheendofeachtradingday.
xiv.gains
NumericvectorofgainsforXIV.Shouldbesamelengthas
contango
anddate-
shiftedonevaluetotheright.Forexample,thevalueof
xiv.gains
should
betheXIVgainforthedayAFTERthecontangovalue.
vxx.gains
NumericvectorofgainsforVXX.Shouldbesamelengthas
contango
anddate-
shiftedonevaluetotheright.Forexample,thevalueof
vxx.gains
should
betheVXXgainforthedayAFTERthecontangovalue.
xiv.cutpoint
NumericvaluegivingthecontangocutpointforXIV,inpercent.
vxx.cutpoint
NumericvaluegivingthecontangocutpointforVXX,inpercent.
initial
Numericvaluegivingtheinitialvalueoftheportfolio.
Details
YoucanhistoricalcontangovaluesfromTheIntelligentInvestorBlog.Youcanclickthe
linkat
http://investing.kuchita.com/2012/06/28/xiv-data-and-pricing-model-since-vix-futures-available-2004/
todownloadazipcontaininganExcelspreadsheet.Then,youwillneedtocalculatewhatever
versionof"contango"youprefer.Itypicallycontangoaswhatpercenthigherthesecond-
monthVIXfuturesareacomparedtothefutures,i.e.dividingthe"2ndmth"columnby
the"1stmth"column,subtracting1,andthenmultiplyingby100.
Ithinkthemostcommonapproachforcontango-basedvolatilitystrategiesisholdingXIV(inverse
volatility)whencontangoisabovesomevalue(e.g.0%,5%,or10%),andholdingcashotherwise.
Youcandothatwiththisfunctionbyleaving
vxx.cutpoint
as
-Inf
.However,youmayalsowant
toholdVXX(volatility)whencontangoisbelowsomevalue(e.g.0%,-5%,-10%),alsoknownas
"backwardation".YoucanimplementanXIV-only,VXX-only,orXIVandVXXstrategywiththis
function.
ToloaddailygainsforXIVand/orVXX,youcanuse
load_gains
,whichusesthe
quantmod
package[1]toloaddatafromYahoo!Finance.Youwillhavetospecifythe
from
and
to
inputsto
matchthedaterangeforyourcontangovalues.
Value
Listcontaining:
1.
Charactervectornamed
holdings
indicatingwhatfundwasheldeachday(XIV,VXX,or
cash).
2.
Numericvectornamed
port.gains
givingtheportfoliogainforeachday,whichwillbe0for
daysthatcashwasheldandtheXIVorVXXgainfordaysthatXIVorVXXwasheld.
3.
Numericvectornamed
port.balances
givingtheportfoliobalanceeachday.
4.
Numericvaluenamed
trades
givingthetotalnumberoftradesexecuted.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
convert_gain
7
convert_gain
ConvertGainfromOneTimeIntervaltoAnother
Description
Forexample,youcanusethisfunctiontooutthatan8tradingdaysis31.9
Usage
convert_gain(gain,units.in=1,units.out=1)
Arguments
gain
Numericvaluespecifyingagain,e.g.0.005for0.5avectorofgains.
units.in
Numericvaluegvingthetimeperiodoverwhichthegainwasachieved.
units.out
Numericvaluegivingthetimeperiodyouwanttoconvertto.
Value
Numericvalueorvector.
Examples
#Calculateannualizedgainforan8%gainovera70-dayperiod
convert_gain(gain=0.08,units.in=70,units.out=252)
#Calculatetheannualgrowthrateofafundthatgains0.02%perday
convert_gain(gain=0.0002,units.in=1,units.out=252)
#Calculatetheannualgrowthrateofafundthatgains1%perweek
convert_gain(gain=0.01,units.in=1,units.out=52)
#YouinvestinAAPLandgain0.5%in17businessdays.Expressasa5-year
#growthrate.
convert_gain(gain=0.005,units.in=17,units.out=252*5)
#Yourportfoliohastripledina13-yearperiod.Calculateyouraverage
#annualgain.
convert_gain(gain=2,units.in=13,units.out=1)
8
diffs
daily_yearly
ConvertDailyGaintoX-yearGain
Description
Forexample,youcanusethisfunctiontocalculatethataninvestmentthatgains0.1days).
Usage
daily_yearly(gain,years=1)
Arguments
gain
Numericvaluespecifyingagain,e.g.0.005for0.5avectorofgains.
years
Numericvalue.
Value
Numericvalueorvector.
Examples
#Calculateannualgainforaninvestmentthatgains0.1%perday
daily_yearly(gain=0.001)
#Calculate5-yeargainscorrespondingtovariousdailygains
daily_yearly(gain=seq(0,0.001,0.0001),years=5)
diffs
LaggedDifferences(AlternateImplementation)
Description
Calculatesdifferencesbetweensubsequent(orlagged)elementsofavector.Verysimilarto
diff
,
butwritteninC++.
Usage
diffs(x,lag=1L)
Arguments
x
Numericvector.
lag
Numericvalue(e.g.2fordifferencesbetween1stand3rdelement,2ndand4th,
...).
gains_graph
9
Value
Numericvector.
Examples
#Generate1millionvaluesfromPoisson(3)distribution
x<-rpois(100000,3)
#Calculatevectorofdifferencesbetweensubsequentvalues
y<-diffs(x)
#CouldgetsameresultfrombaseRfunctiondiff
z<-diff(x)
all.equal(y,z)
#Butdiffsisfaster
benchmark(diffs(x),diff(x),replications=100)
gains_graph
ScatterplotofInvestmentGains
Description
Usefulforvisualizingrelationshipbetweenone(orseveral)investmentsandabenchmark.First
fundin
tickers
,
gains
,or
prices
isusedasthebenchmark.
Usage
gains_graph(tickers=NULL,...,gains=NULL,prices=NULL,
orders=1,add.plot=FALSE,include.legend=TRUE,colors=NULL,
lty=NULL,plot.list=NULL,points.list=NULL,legend.list=NULL,
pdf.list=NULL,bmp.list=NULL,jpeg.list=NULL,png.list=NULL,
tiff.list=NULL)
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
...
Argumentstopassalongwith
tickers
to
load_gains
.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
10
gains_prices
orders
Numericvectorspecifyingtheordersoflinearregressionmodelsforeachy-
axisinvestment.Setto
1
forsimplelinearregression,
2
forlinearregression
withandsecond-orderterms,andsoon.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
include.legend
Logicalvalue.
colors
Charactervectorofcolorsforeachcurve.
lty
Numericvectorspecifyinglinetypesforeachcurve.
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
legend.list
Listofargumentstopassto
legend
.
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,alistcontaininglinearregressionmodelsreturnedby
lm
foreach
investmentvs.thebenchmark.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#PlotdailygainsforSSOandUPROvs.VFINX
fig<-gains_graph(c("VFINX","SSO","UPRO"))
##End(Notrun)
gains_prices
ConvertGainstoPrices
Description
Calculatespricesbasedoninitialbalanceandvectorofgains.
gains_rate
11
Usage
gains_prices(gains,initial=10000)
Arguments
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
initial
Numericvalue.
Value
Numericvalueif
gains
isavector,numericmatrixif
gains
isamatrix.
Examples
#Simulatedailygainsovera5-yearperiod
set.seed(123)
gains<-rnorm(n=252*5,mean=0.001,sd=0.02)
#Plotbalanceovertimeifinitialbalanceis$10,000
prices<-gains_prices(gains)
plot(prices)
gains_rate
CalculateGrowthRateFromaVectorofGains
Description
Theformulaissimply:
prod(gains+1)-1
.If
units.rate
isthenitconvertsto
x-unitgrowthrate.
Usage
gains_rate(gains,units.rate=NULL)
Arguments
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
units.rate
Numericvaluespecifyingthenumberofunitsforgrowthratecalculation,ifyou
wantsomethingotherthantotalgrowth.Forannualizedgrowthrate,setto252
if
gains
hasdailygains,12if
gains
hasmonthlygains,etc.
Value
Numericvalueif
gains
isavector,numericmatrixif
gains
isamatrix.
12
growth_graph
Examples
#Createvectorofdailygainsforahypotheticalstock
daily.gains<-c(-0.02,-0.01,0.01,0.02,0.01)
#Overallgrowthis0.95%
gains_rate(daily.gains)
#Averagedailygrowthis0.19%
gains_rate(daily.gains,1)
#Correspondsto61.0%annualgrowth
gains_rate(daily.gains,252)
growth_graph
GraphInvestmentGrowth
Description
Usefulforcomparingperformanceofinvestmentsovertime.
Usage
growth_graph(tickers=NULL,...,gains=NULL,prices=NULL,
initial="10k",add.plot=FALSE,colors=NULL,lty=NULL,
plot.list=NULL,points.list=NULL,grid.list=NULL,
legend.list=NULL,pdf.list=NULL,bmp.list=NULL,
jpeg.list=NULL,png.list=NULL,tiff.list=NULL)
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
...
Argumentstopassalongwith
tickers
to
load_gains
.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
initial
Numericvaluespecifyingwhatvaluetoscaleinitialpricesto.Canalsobechar-
acterstringendingin"k",e.g.
"10k"
tographgrowthof$10kwithoutallthe
0's.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
colors
Charactervectorofcolorsforeachcurve.
lty
Numericvectorspecifyinglinetypesforeachcurve.
highyield_etfs
13
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
grid.list
Listofargumentstopassto
grid
.
legend.list
Listofargumentstopassto
legend
.
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,alistcontaining:
1.
Numericmatrixnamed
prices
withpricesforeachinvestment.
2.
Numericvectornamed
means
withmeanofgainsforeachinvestment.
3.
Numericmatrixnamed
corr.matrix
withcorrelationmatrixforgainsforeachinvestment.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#Plotgrowthof$10kinVFINXandBRK-B
fig<-growth_graph(c("VFINX","BRK-B"))
##End(Notrun)
highyield_etfs
High-YieldETFsfromETFdb.comandInceptionDates
Description
High-YieldETFsfromETFdb.comandInceptionDates
Source
http://etfdb.com/etfdb-category/high-yield-bonds/#etfs&sort_name=assets_under_management&
sort_order=desc&page=2
14
load_gains
largest_etfs
Largest100MarketCapETFs(asof3/2/18)andInceptionDates
Description
Largest100MarketCapETFs(asof3/2/18)andInceptionDates
Source
http://etfdb.com/compare/market-cap/
load_gains
DownloadandAlignGainsforaSetofTickers
Description
DownloadsandalignshistoricalinvestmentgainsfortickersfromYahoo!Finance,using
the
quantmod
package.
Usage
load_gains(tickers,intercepts=NULL,slopes=NULL,from="1950-01-01",
to=Sys.Date(),time.scale="daily",preto.days=NULL,
prefrom.days=NULL,earliest=FALSE,latest=FALSE)
Arguments
tickers
CharactervectorwithtickersymbolsthatYahoo!Financerecognizes.
intercepts
Numericvectorofvaluestoaddtodailygainsforeachticker.
slopes
Numericvectorofvaluestomultiplydailygainsforeachtickerby.Slopesare
multipliedpriortoaddingintercepts.
from
Dateorcharacterstring(e.g.
"2015-01-15"
.
to
Dateorcharacterstring(e.g.
"2016-01-30"
).
time.scale
Characterstringcontrollingtimeframeforgains.Choicesare
"daily"
,
"monthly"
,
and
"yearly"
.
preto.days
Numericvalue.Ifspecifunctionreturnsgainsfor
preto.days
tradingdays
priorto
to
.Toillustrate,toloadthemostrecent50dailygains,youwouldleave
to
and
time.scale
asthedefaultsandset
preto.days=50
.
prefrom.days
Numericvalue.Iffunctionreturnsgainsfor
prefrom.days
trading
dayspriorto
from
.Usefulwhenyouwanttotestatradingstrategystartingona
particulardate,butthestrategyrequiresdataleadinguptothatdate(e.g.trailing
beta).
load_prices
15
earliest
Logicalvalueforwhethertoretainonlythesubsetoftickerswithdatagoingthe
furthestback.Setto
FALSE
ifyouwantalltickersretainedandgainsovertheir
mutuallifetimes.
latest
Logicalvalueforwhethertoretainonlythesubsetoftickerswithdatagoingthe
furthestforward,e.g.droppingfundsthatwerediscontinuedatsomepoint.
Details
Inaligninghistoricalprices,datesonwhichnotallfundshavedataaresimplydropped.Messages
areprintedindicatingwhichdatesaredroppedforwhichtickers.
Value
Numericmatrix.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#LoadgainsforNetflixandAmazonovertheirmutuallifetimes
gains<-load_gains(c("NFLX","AMZN"))
##End(Notrun)
load_prices
DownloadandAlignHistoricalPricesforaSetofTickers
Description
DownloadsandalignshistoricalpricesfortickersfromYahoo!Finance,usingthe
quant-
mod
package.
Usage
load_prices(tickers,intercepts=NULL,slopes=NULL,
from="1950-01-01",to=Sys.Date(),time.scale="daily",
preto.days=NULL,prefrom.days=NULL,initial=NULL,
earliest=FALSE,latest=FALSE)
16
load_prices
Arguments
tickers
CharactervectorwithtickersymbolsthatYahoo!Financerecognizes.
intercepts
Numericvectorofvaluestoaddtodailygainsforeachticker.
slopes
Numericvectorofvaluestomultiplydailygainsforeachtickerby.Slopesare
multipliedpriortoaddingintercepts.
from
Dateorcharacterstring(e.g.
"2015-01-15"
.
to
Dateorcharacterstring(e.g.
"2016-01-30"
).
time.scale
Characterstringcontrollingtimeframeforgains.Choicesare
"daily"
,
"monthly"
,
and
"yearly"
.
preto.days
Numericvalue.Ifspecifunctionreturnsgainsfor
preto.days
tradingdays
priorto
to
.Toillustrate,toloadthemostrecent50dailygains,youwouldleave
to
and
time.scale
asthedefaultsandset
preto.days=50
.
prefrom.days
Numericvalue.Iffunctionreturnsgainsfor
prefrom.days
trading
dayspriorto
from
.Usefulwhenyouwanttotestatradingstrategystartingona
particulardate,butthestrategyrequiresdataleadinguptothatdate(e.g.trailing
beta).
initial
Numericvaluespecifyingwhatvaluetoscaleinitialpricesto.
earliest
Logicalvalueforwhethertoretainonlythesubsetoftickerswithdatagoingthe
furthestback.Setto
FALSE
ifyouwantalltickersretainedandgainsovertheir
mutuallifetimes.
latest
Logicalvalueforwhethertoretainonlythesubsetoftickerswithdatagoingthe
furthestforward,e.g.droppingfundsthatwerediscontinuedatsomepoint.
Details
Inaligninghistoricalprices,datesonwhichnotallfundshavedataaresimplydropped.Messages
areprintedindicatingwhichdatesaredroppedforwhichtickers.
Value
Numericmatrix.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#LoadpricesforNetflixandAmazonovertheirmutuallifetimes
prices<-load_prices(c("NFLX","AMZN"))
##End(Notrun)
mdd
17
mdd
MaximumDrawdown
Description
Calculatesmaximumdrawdownfromvectorofclosingprices,highsandlows,orgains.
Usage
mdd(prices=NULL,highs=NULL,lows=NULL,gains=NULL,
indices=FALSE)
Arguments
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
highs
Numericvectorofdailyhighprices.
lows
Numericvectorofdailylowprices.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
indices
Logicalvalueforwhethertoincludeindicesforwhenthemaximumdrawdown
occurred.
Value
Numericvalue,vector,ormatrixdependingon
indices
andwhetherthereis1fundorseveral.
Examples
##Notrun:
#Simulateminute-to-minutestockgainsovera2-yearperiod
set.seed(123)
stock.gains<-rnorm(6.5*60*252*2,0.000005,0.001)
#Converttostockpricesassuminganinitialpriceof$9.50pershare
stock.prices<-gains_prices(gains=stock.gains,initial=9.50)
#Plotminute-to-minutestockprices(200kdatapoint,maybeslow)
plot(stock.prices)
#Maximumdrawdownbasedonstockprices
mdd(prices=stock.prices)
#Sameanswerusinggainsratherthanprices
mdd(gains=stock.gains)
##End(Notrun)
18
metrics
metrics
CalculateVariousPerformanceMetrics
Description
Usefulforcomparingmetricsforseveralinvestments.Theinvestmentisusedasthebenchmark
ifrequestedmetricsrequireone.
Usage
metrics(tickers=NULL,...,gains=NULL,prices=NULL,
perf.metrics=c("mean","sd","growth","cagr","mdd","sharpe","sortino",
"alpha","beta","r.squared","pearson","spearman","auto.pearson",
"auto.spearman"))
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
...
Argumentstopassalongwith
tickers
to
load_gains
.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
perf.metrics
Charactervectorspecifyingmetricstocalculate.
Value
Listcontaining:
1.
Numericmatrixnamed
perf.metrics
withperformancemetrics.
2.
Numericmatrixnamed
cor.mat
withcorrelationmatrixforgainsforthevariousinvestments.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#CalculateperformancemetricsforSSOandUPRO,usingSPYasbenchmark
#foralphaandbeta
metrics1<-metrics(tickers=c("SPY","SSO","UPRO"))
##End(Notrun)
onemetric_graph
19
onemetric_graph
GraphPerformanceMetricforVariousInvestments
Description
Usefulforvisualizingtheperformanceofagroupofinvestments.Theinvestmentisusedas
thebenchmarkiftherequestedmetricrequiresone.
Usage
onemetric_graph(tickers=NULL,...,gains=NULL,prices=NULL,
y.metric="cagr",add.plot=FALSE,sort.tickers=TRUE,
plot.list=NULL,points.list=NULL,axis.list=NULL,
pdf.list=NULL,bmp.list=NULL,jpeg.list=NULL,png.list=NULL,
tiff.list=NULL)
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
...
Argumentstopassalongwith
tickers
to
load_gains
.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
y.metric
Characterstringspecifyingy-axisperformancemetric.Choicesare:
"mean"
or
"sd"
formeanorstandarddeviationofgains.
"growth"
or
"cagr"
fortotalorannualizedgrowth.
"mdd"
formaximumdrawdown.
"sharpe"
or
"sortino"
forSharpeorSortinoratio.
"alpha"
,
"beta"
,or
"r.squared"
forthosemetricsfromalinearregres-
siononbenchmarkfund.
"pearson"
or
"spearman"
forPearsonorSpearmancorrelationwithbenchmark
fund.
"auto.pearson"
or
"auto.spearman"
forPearsonorSpearmanautocorrela-
tion,asthecorrelationbetweensubsequentgains.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
sort.tickers
Logicalvalueforwhethertosortinvestmentsindecreasingorderoftheperfor-
mancemetric.
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
axis.list
Listofargumentstopassto
axis
.
20
onemetric_overtime_graph
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,adataframecontainingtheperformancemetricforeachinvestment.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#CompareannualizedgrowthforVFINX,SSO,andUPRO
fig<-onemetric_graph(tickers=c("VFINX","SSO","UPRO"),
plot.list=list(ylim=c(0,50)))
##End(Notrun)
onemetric_overtime_graph
GraphPerformanceMetricOverTimeforVariousInvestments
Description
Usefulforvisualizingtheperformanceofagroupofinvestmentsovertime.Theinvestmentis
usedasthebenchmarkiftherequestedmetricrequiresone.
Usage
onemetric_overtime_graph(tickers=NULL,...,gains=NULL,prices=NULL,
y.metric="cagr",window.units=50,add.plot=FALSE,colors=NULL,
lty=NULL,plot.list=NULL,points.list=NULL,legend.list=NULL,
pdf.list=NULL,bmp.list=NULL,jpeg.list=NULL,png.list=NULL,
tiff.list=NULL)
onemetric_overtime_graph
21
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
...
Argumentstopassalongwith
tickers
to
load_gains
.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
y.metric
Characterstringspecifyingy-axisperformancemetric.Choicesare:
"mean"
or
"sd"
formeanorstandarddeviationofgains.
"growth"
or
"cagr"
fortotalorannualizedgrowth.
"mdd"
formaximumdrawdown.
"sharpe"
or
"sortino"
forSharpeorSortinoratio.
"alpha"
,
"beta"
,or
"r.squared"
forthosemetricsfromalinearregres-
siononbenchmarkfund.
"pearson"
or
"spearman"
forPearsonorSpearmancorrelationwithbenchmark
fund.
"auto.pearson"
or
"auto.spearman"
forPearsonorSpearmanautocorrela-
tion,asthecorrelationbetweensubsequentgains.
window.units
Numericvaluespecifyingthewidthofthemovingwindow.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
colors
Charactervectorofcolorsforeachcurve.
lty
Numericvectorspecifyinglinetypesforeachcurve.
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
legend.list
Listofargumentstopassto
legend
.
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,anumericmatrixcontainingtheperformancemetricovertimeforeach
investment.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
22
pchanges
Examples
##Notrun:
#PlotBRK-B
'
s50-dayalphaovertimesincethestartof2016
fig<-onemetric_overtime_graph(tickers=c("VFINX","BRK-B"),
y.metric="alpha",
from="2016-01-01")
##End(Notrun)
pchanges
LaggedProportionChanges
Description
Calculatesproportionchangesbetweensubsequent(orlagged)elementsofavector.
Usage
pchanges(x,lag=1L)
Arguments
x
Numericvector.
lag
Numericvalue(e.g.2fordifferencesbetween1stand3rdelement,2ndand4th,
...).
Value
Numericvector.
Examples
#Generate10valuesfromN(0,1)
x<-rnorm(10)
#Calculatevectorofproportionchangesbetweensubsequentvalues
(y<-pchanges(x))
#EquivalentbaseRcomputation
len<-length(x)
p1<-x[2:len]
p2<-x[1:(len-1)]
y2<-p1/p2-1
all.equal(y,y2)
pdiffs
23
pdiffs
LaggedProportionDifferences
Description
Calculatesproportiondifferencesbetweensubsequent(orlagged)elementsofavector.
Usage
pdiffs(x,lag=1L)
Arguments
x
Numericvector.
lag
Numericvalue(e.g.2fordifferencesbetween1stand3rdelement,2ndand4th,
...).
Value
Numericvector.
Examples
#Generate10valuesfromN(0,1)
x<-rnorm(10)
#Calculatevectorofproportiondifferencesbetweensubsequentvalues
(y<-pdiffs(x))
#EquivalentbaseRcomputation
len<-length(x)
p1<-x[2:len]
p2<-x[1:(len-1)]
y2<-(p1-p2)/(0.5*(p1+p2))
all.equal(y,y2)
prices_gains
ConvertPricestoGains
Description
Calculatesgainsbasedonvectorormatrixofprices.
24
prices_rate
Usage
prices_gains(prices)
Arguments
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
Value
Numericvectorormatrix.
Examples
##Notrun:
#Load2017pricesforNetflixandAmazon,andcalculategrowthof$10k
prices<-load_prices(c("NFLX","AMZN"),initial=1000)
#Calculategains
gains<-prices_gains(prices)
##End(Notrun)
prices_rate
CalculateGrowthRateFromaVectorofPrices
Description
Theformulaissimply:
prices[length(prices)]/prices[1]-1
.If
units.rate
is
thenitconvertstox-unitgrowthrate.
Usage
prices_rate(prices,units.rate=NULL)
Arguments
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
units.rate
Numericvaluespecifyingthenumberofunitsforgrowthratecalculation,ifyou
wantsomethingotherthantotalgrowth.Forannualizedgrowthrate,setto252
if
prices
hasdailyprices,12if
prices
hasmonthlyprices,etc.
Value
Numericvalueif
prices
isavector,numericmatrixif
prices
isamatrix.
ratios
25
Examples
#Createvectorofdailyclosingpricesforahypotheticalstock
prices<-c(100.4,98.7,101.3,101.0,100.9)
#Overallgrowthis0.50%
prices_rate(prices)
#Averagedailygrowthis0.12%
prices_rate(prices,1)
#Correspondsto36.7%annualizedgrowth
prices_rate(prices,252)
ratios
RatiosofSubsequentElementsinaVector
Description
Calculatesvectorofratiosofavector,i.e.ratioof
x[2]
to
x[1]
,ratioof
x[3]
to
x[2]
,andsoforth.
Usage
ratios(x)
Arguments
x
Numericvector.
Value
Numericvector.
Examples
#Generate10valuesfromN(0,1)
x<-rnorm(10)
#Calculatevectorofratios
(y<-ratios(x))
#SlowerbaseRcomputation
len<-length(x)
y2<-x[2:len]/x[1:(len-1)]
all.equal(y,y2)
26
rrr
rrr
Risk-ReturnRatio
Description
Calculatesrisk-returnratio,asgrowthratedividedbymaximumdrawdown.
Usage
rrr(prices=NULL,gains=NULL)
Arguments
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
Value
Numericvalueorvector.
Examples
#Simulatedailygainsovera5-yearperiod
set.seed(123)
stock.gains<-rnorm(252*5,0.0005,0.01)
#Converttodailybalancesassuminganinitialbalanceof$10,000
daily.balances<-gains_prices(stock.gains+1)
#Totalreturnisabout1.23
daily.balances[length(daily.balances)]/daily.balances[1]-1
#Maximumdrawdownisabout0.19
mdd(prices=daily.balances)
#Ratioofthesetwoisabout6.48
(daily.balances[length(daily.balances)]/daily.balances[1]-1)/
mdd(daily.balances)
#Easiertocalculateusingrrrfunction
rrr(daily.balances)
sector_spdr_etfs
27
sector_spdr_etfs
SectorSPDRETFsandInceptionDates
Description
SectorSPDRETFsandInceptionDates
Source
http://www.sectorspdr.com/sectorspdr/sectors/performance
sharpe
SharpeRatio
Description
CalculatesSharperatiofromvectorofgainsorprices.Theformulais:
(mean(gains)-rf)/sd(gains)
,
where
rf
issomerisk-freerateofreturn.
Usage
sharpe(gains=NULL,prices=NULL,rf=0)
Arguments
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
rf
Numericvalue.
Value
Numericvalue.
Examples
#Simulatedailygainsovera5-yearperiod
set.seed(123)
stock.gains<-rnorm(252*5,0.0005,0.01)
#CalculateSharperatiousingrisk-freereturnof0
sharpe(stock.gains)
28
stocks
sortino
SortinoRatio
Description
CalculatesSortinoratiofromvectorofgainsorprices.Theformulais:
(mean(gains)-rf)/sd(gains[gains<0])
,
where
rf
issomerisk-freerateofreturn.
Usage
sortino(gains=NULL,prices=NULL,rf=0)
Arguments
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
rf
Numericvalue.
Value
Numericvalueorvector.
Examples
#Simulatedailygainsovera5-yearperiod
set.seed(123)
stock.gains<-rnorm(252*5,0.0005,0.01)
#CalculateSortinoratiousingrisk-freereturnof0
sortino(stock.gains)
stocks
StockMarketAnalysis
Description
Functionsforanalyzingstocksorotherinvestments.Mainfeaturesareloadingandaligninghistor-
icaldatafortickersymbols,calculatingperformancemetricsforindividualfundsorportfolios(e.g.
annualizedgrowth,maximumdrawdown,Sharpe/Sortinoratio),andcreatinggraphs.C++codeis
usedtoimproveprocessingspeedwherepossible.
Details
targetall
29
Package:stocks
Type:Package
Version:1.1.4
Date:2018-08-30
License:GPL-3
See
CRANdocumentation
forfulllistoffunctionsandthe
GitHubpage
foranoverviewofthe
packagewithsomeexamples.
Author(s)
DaneR.VanDomelen
<vandomed@gmail.com>
References
Eddelbuettel,D.andFrancois,R.(2011)Rcpp:SeamlessRandC++Integration.JournalofStatis-
ticalSoftware,40(8),1-18.
http://www.jstatsoft.org/v40/i08/
.
Eddelbuettel,D.(2013)SeamlessRandC++IntegrationwithRcpp.Springer,NewYork.ISBN
978-1-4614-6867-7.
Eddelbuettel,D.andBalamuta,J.J.(2017).ExtendingRwithC++:ABriefIntroductiontoRcpp.
PeerJPreprints5:e3188v1.
https://doi.org/10.7287/peerj.preprints.3188v1
.
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Acknowledgment:ThismaterialisbaseduponworksupportedbytheNationalScienceFoundation
GraduateResearchFellowshipunderGrantNo.DGE-0940903.
targetall
BacktestaFixed-AllocationTradingStrategy
Description
Implementsatradingstrategyaimedatmaintainingaedallocationtoeachofseveralfunds,
rebalancingwhentheeffectiveallocationsdeviatetoofarfromthetargets.
Usage
targetall(tickers=NULL,intercepts=NULL,slopes=NULL,...,
tickers.gains=NULL,target.alls=NULL,tol=0.05,
rebalance.cost=0,initial=10000)
30
targetbeta_twofunds
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
intercepts
Numericvectorofvaluestoaddtodailygainsforeachticker.
slopes
Numericvectorofvaluestomultiplydailygainsforeachtickerby.Slopesare
multipliedpriortoaddingintercepts.
...
Argumentstopassalongwith
tickers
to
load_gains
.
tickers.gains
Numericmatrixofgains,whereeachcolumnhasgainsforaparticularfund.
target.alls
Numericvectorspecifyingtargetallocationstoeachfund.Ifequal
allocationsareused(e.g.1/3,1/3,1/3ifthereare3funds).
tol
Numericvalueindicatinghowfartheeffectiveallocationscandriftawayfrom
thetargetsbeforerebalancing.
rebalance.cost
Numericvaluespecifyingtotalcostofeachrebalancingtrade.
initial
Numericvaluespecifyingwhatvaluetoscaleinitialpricesto.
Value
Listcontaining:
1.
Numericmatrixnamed
fund.balances
givingfundbalancesovertime.
2.
Numericvaluenamed
rebalance.count
givingthenumberofrebalancingtradesexecuted.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#Backtestequal-allocationUPRO/VBLTX/VWEHXstrategy
port<-targetall(tickers=c("UPRO","VBLTX","VWEHX"))
plot(port$fund.balances[,"Portfolio"])
##End(Notrun)
targetbeta_twofunds
BacktestaTwo-FundStrategythatTargetsaCertainBeta
Description
Implementsatwo-fundstrategywhereallocationstoeachfundareadjustedtomaintainsome
userportfoliobeta.Forexample,youcouldback-testazero-beta(i.e.marketneutral)
UPRO/VBLTXstrategyusingthisfunction.
targetbeta_twofunds
31
Usage
targetbeta_twofunds(tickers=NULL,intercepts=NULL,slopes=NULL,...,
benchmark.ticker=NULL,reference.tickers=NULL,tickers.gains=NULL,
benchmark.gains=NULL,reference.gains=NULL,target.beta=0,
tol=0.15,window.units=50,failure.method="closer",
maxall.tol=tol-0.05,initial=10000)
Arguments
tickers
Charactervectorspecifying2tickersymbolsthatYahoo!Financerecognizes,if
youwanttodownloaddataonthe.
intercepts
Numericvectorofvaluestoaddtodailygainsforeachticker.
slopes
Numericvectorofvaluestomultiplydailygainsforeachtickerby.Slopesare
multipliedpriortoaddingintercepts.
...
Argumentstopassalongwith
tickers
to
load_gains
.
benchmark.ticker
Characterstringspecifyingtickersymbolforbenchmarkindexforcalculating
beta.Ifthefundin
tickers
isusedasthebenchmark.
reference.tickers
Charactervectoroftickersymbolstoincludeongraphasdatapointsforcom-
parativepurposes.
tickers.gains
Numericmatrixofgains,whereeachcolumnhasgainsforaparticularfund.
benchmark.gains
Numericvectorofgainsforthebenchmarkindexforcalculatingbeta.Ifun-
thefundin
tickers.gains
isusedasthebenchmark.
reference.gains
Numericvectorormatrixofgainsforfundstoincludeongraphasdatapoints
forcomparativepurposes.
target.beta
Numericvalue.
tol
Numericvaluespecifyinghowfartheeffectiveportfoliobetahastodeviatefrom
target.beta
totriggerarebalancingtrade.
window.units
Numericvaluespecifyingthewidthofthetrailingmovingwindowusedtoesti-
mateeachfund'sbeta.
failure.method
Characterstringorvectorspecifyingmethod(s)tousewhenfundbetasaresuch
thatthetargetportfoliobetacannotbeachieved.Choicesare
"cash"
,
"fund1"
,
"fund2"
,
"fund1.maxall"
,
"fund2.maxall"
,
"inverse1"
,
"inverse2"
,and
"closer"
.SeeDetails.
maxall.tol
Numericvaluespecifyingtolerancetousewhenimplementingthe
"fund1.maxall"
or
"fund2.maxall"
failuremethod.Toillustrate,if
target.beta=0
,fund1
hasacurrentbetaof1,fund2hasacurrentbetaof0.25,
failure.method="fund2.maxall"
,
and
maxall.tol=0.1
,atradewillbetriggeredthatresultsin40%fund2and
60%cash.Theportfoliobetais
0.4*0.25=0.1
.Thereasonyoumightwant
maxall.tol
tobelessthan
tol
istoavoidfrequentlytriggeringanothertrade
ontheverynextday,asfund2'sbetachangesalittleandmovestheportfolio
betaoutsideof
[target.beta-tol,target.beta+tol]
.
initial
Numericvaluespecifyingwhatvaluetoscaleinitialpricesto.
32
targetbeta_twofunds
Details
Thegeneralimplementationisasfollows.Betaforeachofthetwofundsisestimatedbasedonthe

window.units
gains.Initialallocationsareselectedtoachieveportfoliobetaof
target.beta
.
Ifthatisnotpossible-forexample,if
target.beta=0
andbothfundshavepositivebeta-then
theactiontakendependsonwhatmethodisselectedthroughthe
failure.method
input(details
below).
Assumingthetargetbetaisattainable,thefunctionmovesover1day,andapplieseachfund'sgains
forthatday.Itthenre-calculateseachfund'sbetabasedonthe
window.units
-widthinterval,and
determinestheeffectiveportfoliobetabasedonfundallocationsandbetas.Iftheeffectivebetais
outsideof
[target.beta-tol,target.beta+tol]
,arebalancingtradeistriggered.As
before,ifthetargetbetacannotbeachieved,certainactionsaretakendependingontheselected
method.
Whenoutsideofatradebecausethetargetbetacouldnotbeachieved,thefunctionattemptsto
rebalanceeachtimeitshiftsovertoanewday,regardlessoftheeffectiveportfoliobeta.
When
failure.method="cash"
,theentireportfoliobalanceisallocatedtocashwhenthetarget
betacannotbeachieved.
When
failure.method="fund1"
(or
"fund2"
),theentireportfoliobalanceisallocatedtothe
(orsecond)fundwhenthetargetbetacannotbeachieved.
When
failure.method="fund1.maxall"
(or
"fund2.maxall"
),whenthetargetbetacannotbe
achieved,fund1(orfund2)iscombinedwithcash,withthefund1(fund2)allocationashighas
possiblewhilestayingwithin
maxall.tol
of
target.beta
.
When
failure.method="inverse1"
(or
"inverse2"
),aninverseversionofthe(orsecond)
fundisusedwhenthetargetbetacannotbeachieved.Inmanycaseswherethetargetbetacannot
beachievedwiththetwofunds,itcanbeachievedwithaninverseversionofoneandtheother.If
thetargetbetastillcannotbeachieved,theentireportfoliobalanceisallocatedtocash.
When
failure.method="closer"
,theentireportfoliobalanceisallocatedtowhicheverfund
hasabetacloserto
target.beta
.
Value
Foreachmethod,a4-elementlistcontaining:
1.
Numericmatrixnamed
fund.balances
givingfundbalancesovertime.
2.
Numericmatrixnamed
fund.betas
givingfundbetasovertime.
3.
Numericvectornamed
effective.betas
givingeffectiveportfoliobetaovertime.
4.
Numericvaluenamed
trades
givingthetotalnumberoftradesexecuted.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
threefunds_graph
33
Examples
##Notrun:
#Backtestzero-betaUPRO/VBLTXstrategy
beta0<-targetbeta_twofunds(tickers=c("UPRO","VBLTX"),target.beta=0)
plot(beta0$fund.balances[,"Portfolio"])
##End(Notrun)
threefunds_graph
GraphOnePerformanceMetricvs.AnotherforThree-FundPortfolio
asAllocationVaries
Description
Usefulforvisualizingperformanceofthree-fundportfolios,typicallybyplottingameasureof
growthvs.ameasureofvolatility.Onlyworksforonethree-fundsetatatime.
Usage
threefunds_graph(tickers=NULL,intercepts=NULL,slopes=NULL,...,
benchmark.tickers=NULL,reference.tickers=NULL,
tickers.gains=NULL,benchmark.gains=NULL,reference.gains=NULL,
step.data=0.0025,step.points=0.1,step.curves=0.2,
x.metric="sd",y.metric="mean",tickerlabel.offsets=NULL,
reflabel.offsets=NULL,add.plot=FALSE,colors=NULL,lty=NULL,
plot.list=NULL,points.list=NULL,text.list=NULL,
pdf.list=NULL,bmp.list=NULL,jpeg.list=NULL,png.list=NULL,
tiff.list=NULL)
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
intercepts
Numericvectorofvaluestoaddtodailygainsforeachticker.
slopes
Numericvectorofvaluestomultiplydailygainsforeachtickerby.Slopesare
multipliedpriortoaddingintercepts.
...
Argumentstopassalongwith
tickers
to
load_gains
.
benchmark.tickers
Charactervectoroflength1or2indicatingtickersymbolsforbenchmarkin-
dexes.Onlyusedif
x.metric
and/or
y.metric
requirebenchmarkindexesto
calculate.Forexample,toplotcorrelationwithSPYonthex-axisandcorrela-
tionwithTLTonthey-axis,set
x.metric="pearson"
,
y.metric="pearson2"
(i.e.Pearsoncorrelationwith2ndbenchmark),and
benchmark.tickers=c("SPY","TLT")
.
reference.tickers
Charactervectoroftickersymbolstoincludeongraphasdatapointsforcom-
parativepurposes.
34
threefunds_graph
tickers.gains
Numericmatrixofgains,whereeachcolumnhasgainsforaparticularfund.
benchmark.gains
Numericvectorormatrixofgainsfor1or2benchmarkindexes.Onlyusedif
x.metric
and/or
y.metric
requirebenchmarkindexestocalculate.Forexam-
ple,toplotcorrelationwithSPYonthex-axisandcorrelationwithTLTonthe
y-axis,set
x.metric="pearson"
and
y.metric="pearson2"
,andinput
benchmark.gains
asa2-columnmatrixofgainsforSPYandTLT.
reference.gains
Numericvectorormatrixofgainsforfundstoincludeongraphasdatapoints
forcomparativepurposes.
step.data
Numericvaluespecifyingallocationincrementsforplottingcurves.
step.points
Numericvaluespecifyingallocationincrementsforaddingdatapointsontopof
curves.Setto
NULL
tosuppressdatapoints.
step.curves
Numericvaluespecifyingallocationincrementsforfundineachset.
x.metric
Characterstringspecifyingx-axisperformancemetric.Choicesare:
"mean"
or
"sd"
formeanorstandarddeviationofgains
"growth"
or
"cagr"
fortotalorannualizedgrowth
"mdd"
formaximumdrawdown
"sharpe"
or
"sortino"
forSharpeorSortinoratio
"alpha"
,
"beta"
,or
"r.squared"
forthosemetricsfromalinearregres-
siononbenchmarkfund
"pearson"
or
"spearman"
forPearsonorSpearmancorrelationwithbenchmark
fund
"alpha2"
,
"beta2"
,
"r.squared2"
,
"pearson2"
,or
"spearman2"
forsameas
previouslydescribed,butusingthesecondbenchmarkindex
"auto.pearson"
or
"auto.spearman"
forPearsonorSpearmanautocorrela-
tion,asthecorrelationbetweensubsequentgains
"allocation"
forallocationtofundineachpair.
y.metric
Sameas
x.metric
,butforthey-axis
tickerlabel.offsets
Eitheranumericvectoroflength2givingthex-andy-axisoffsetsforallticker
labels,ora2-columnmatrixwhereeachrowgivesthex-andy-axisoffsetsfor
aticker.
reflabel.offsets
Eitheranumericvectoroflength2givingthex-andy-axisoffsetsforallrefer-
encetickerlabels,ora2-columnmatrixwhereeachrowgivesthex-andy-axis
offsetsforareferenceticker.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
colors
Charactervectorofcolorsforeachcurve.
lty
Numericvectorspecifyinglinetypesforeachcurve.
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
ticker_dates
35
text.list
Listofargumentstopassto
text
.
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,alistcontaining:
1.
Listnamed
portfolio.xy
whereeachelementisatwo-columnmatrixofx-andy-axisvalues
foracurve.
2.
Numericvectornamed
means
withmeangainsforeachfund.
3.
Numericmatrixnamed
corr.matrix
withacorrelationmatrixforgainsforeachfund.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#Plotmeanvs.SDforUPRO/VBLTX/VWEHXportfolio,andcomparetoVFINXand
#BRK-B
fig<-threefunds_graph(tickers=c("VWEHX","VBLTX","UPRO"),
reference.tickers=c("VFINX","BRK-B"))
##End(Notrun)
ticker_dates
GetYahoo!FinanceStart/EndDatesforTickers
Description
Typicallyusefulfordeterminingatimeperiodoverwhichtocompareseveralfunds.
Usage
ticker_dates(tickers,from="1950-01-01",to=Sys.Date())
36
twofunds_graph
Arguments
tickers
CharactervectorwithtickersymbolsthatYahoo!Financerecognizes.
from
Dateorcharacterstring(e.g.
"2015-01-15"
.
to
Dateorcharacterstring(e.g.
"2016-01-30"
).
Value
Dataframewithtickersymbol,startdate,enddate,andnumberoftradingdaysforeachticker.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#SeewhatdatesareavailableforAppleandAmazon
ticker_dates(c("AAPL","AMZN"))
##End(Notrun)
twofunds_graph
GraphOnePerformanceMetricvs.AnotherforTwo-FundPortfolios
asAllocationVaries
Description
Usefulforvisualizingperformanceoftwo-fundportfolios,typicallybyplottingameasureofgrowth
vs.ameasureofvolatility.Firsttwoinvestmentsareusedasthetwo-fundpair,nexttwoasthe
secondtwo-fundpair,andsoon.
Usage
twofunds_graph(tickers=NULL,intercepts=NULL,slopes=NULL,...,
benchmark.tickers=NULL,reference.tickers=NULL,
tickers.gains=NULL,benchmark.gains=NULL,reference.gains=NULL,
step.data=0.0025,step.points=0.1,x.metric="sd",
y.metric="mean",tickerlabel.offsets=NULL,reflabel.offsets=NULL,
add.plot=FALSE,colors=NULL,lty=NULL,plot.list=NULL,
points.list=NULL,text.list=NULL,pdf.list=NULL,
bmp.list=NULL,jpeg.list=NULL,png.list=NULL,tiff.list=NULL)
twofunds_graph
37
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
intercepts
Numericvectorofvaluestoaddtodailygainsforeachticker.
slopes
Numericvectorofvaluestomultiplydailygainsforeachtickerby.Slopesare
multipliedpriortoaddingintercepts.
...
Argumentstopassalongwith
tickers
to
load_gains
.
benchmark.tickers
Charactervectoroflength1or2indicatingtickersymbolsforbenchmarkin-
dexes.Onlyusedif
x.metric
and/or
y.metric
requirebenchmarkindexesto
calculate.Forexample,toplotcorrelationwithSPYonthex-axisandcorrela-
tionwithTLTonthey-axis,set
x.metric="pearson"
,
y.metric="pearson2"
(i.e.Pearsoncorrelationwith2ndbenchmark),and
benchmark.tickers=c("SPY","TLT")
.
reference.tickers
Charactervectoroftickersymbolstoincludeongraphasdatapointsforcom-
parativepurposes.
tickers.gains
Numericmatrixofgains,whereeachcolumnhasgainsforaparticularfund.
benchmark.gains
Numericvectorormatrixofgainsfor1or2benchmarkindexes.Onlyusedif
x.metric
and/or
y.metric
requirebenchmarkindexestocalculate.Forexam-
ple,toplotcorrelationwithSPYonthex-axisandcorrelationwithTLTonthe
y-axis,set
x.metric="pearson"
and
y.metric="pearson2"
,andinput
benchmark.gains
asa2-columnmatrixofgainsforSPYandTLT.
reference.gains
Numericvectorormatrixofgainsforfundstoincludeongraphasdatapoints
forcomparativepurposes.
step.data
Numericvaluespecifyingallocationincrementsforplottingcurves.
step.points
Numericvaluespecifyingallocationincrementsforaddingdatapointsontopof
curves.Setto
NULL
tosuppressdatapoints.
x.metric
Characterstringspecifyingx-axisperformancemetric.Choicesare:
"mean"
or
"sd"
formeanorstandarddeviationofgains
"growth"
or
"cagr"
fortotalorannualizedgrowth
"mdd"
formaximumdrawdown
"sharpe"
or
"sortino"
forSharpeorSortinoratio
"alpha"
,
"beta"
,or
"r.squared"
forthosemetricsfromalinearregres-
siononbenchmarkfund
"pearson"
or
"spearman"
forPearsonorSpearmancorrelationwithbenchmark
fund
"alpha2"
,
"beta2"
,
"r.squared2"
,
"pearson2"
,or
"spearman2"
forsameas
previouslydescribed,butusingthesecondbenchmarkindex
"auto.pearson"
or
"auto.spearman"
forPearsonorSpearmanautocorrela-
tion,asthecorrelationbetweensubsequentgains
"allocation"
forallocationtofundineachpair.
38
twofunds_graph
y.metric
Sameas
x.metric
,butforthey-axis
tickerlabel.offsets
Eitheranumericvectoroflength2givingthex-andy-axisoffsetsforallticker
labels,ora2-columnmatrixwhereeachrowgivesthex-andy-axisoffsetsfor
aticker.
reflabel.offsets
Eitheranumericvectoroflength2givingthex-andy-axisoffsetsforallrefer-
encetickerlabels,ora2-columnmatrixwhereeachrowgivesthex-andy-axis
offsetsforareferenceticker.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
colors
Charactervectorofcolorsforeachcurve.
lty
Numericvectorspecifyinglinetypesforeachcurve.
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
text.list
Listofargumentstopassto
text
.
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,alistcontaining:
1.
Listnamed
portfolio.xy
whereeachelementisatwo-columnmatrixofx-andy-axisvalues
forafundpair.
2.
Numericvectornamed
means
withmeangainsforeachfund.
3.
Numericmatrixnamed
corr.matrix
withacorrelationmatrixforgainsforeachfund.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#Plotmeanvs.SDforUPRO/VBLTXportfolio,andcomparetoVFINXandBRK-B
fig1<-twofunds_graph(tickers=c("UPRO","VBLTX"),
reference.tickers=c("VFINX","BRK-B"))
#Samefunds,butannualizedgrowthvs.maximumdrawdown
fig2<-twofunds_graph(tickers=c("UPRO","VBLTX"),
reference.tickers=c("VFINX","BRK-B"),
twometrics_graph
39
x.metric="mdd",y.metric="cagr")
##End(Notrun)
twometrics_graph
GraphOnePerformanceMetricvs.AnotherforVariousInvestments
Description
Usefulforvisualizingtheperformanceofagroupofinvestments.Theinvestmentisusedas
thebenchmarkif
x.metric
or
y.metric
requireonebenchmark,andthetwoinvestmentsare
usedasbenchmarksif
x.metric
and
y.metric
requiredifferentbenchmarks.
Usage
twometrics_graph(tickers=NULL,...,gains=NULL,prices=NULL,
x.metric="mdd",y.metric="cagr",tickerlabel.offsets=NULL,
add.plot=FALSE,colors=NULL,plot.list=NULL,points.list=NULL,
text.list=NULL,pdf.list=NULL,bmp.list=NULL,jpeg.list=NULL,
png.list=NULL,tiff.list=NULL)
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
...
Argumentstopassalongwith
tickers
to
load_gains
.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
x.metric
Characterstringspecifyingx-axisperformancemetric.Choicesare:
"mean"
or
"sd"
formeanorstandarddeviationofgains.
"growth"
or
"cagr"
fortotalorannualizedgrowth.
"mdd"
formaximumdrawdown.
"sharpe"
or
"sortino"
forSharpeorSortinoratio.
"alpha"
,
"beta"
,or
"r.squared"
forthosemetricsfromalinearregres-
siononbenchmarkfund.
"pearson"
or
"spearman"
forPearsonorSpearmancorrelationwithbenchmark
fund.
"alpha2"
,
"beta2"
,
"r.squared2"
,
"pearson2"
,or
"spearman2"
forsameas
previouslydescribed,butusingthesecondbenchmarkindex.
"auto.pearson"
or
"auto.spearman"
forPearsonorSpearmanautocorrela-
tion,asthecorrelationbetweensubsequentgains.
y.metric
Sameas
x.metric
,butforthey-axis.
40
vanguard_balanced_funds
tickerlabel.offsets
Eitheranumericvectoroflength2givingthex-andy-axisoffsetsforallticker
labels,ora2-columnmatrixwhereeachrowgivesthex-andy-axisoffsetsfor
aticker.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
colors
Charactervectorofcolorsforeachcurve.
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
text.list
Listofargumentstopassto
text
.
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,adataframecontainingtheperformancemetricsforeachinvestment.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#Plotannualizedgrowthvs.maximumdrawdownforVFINX,SSO,andUPRO
fig<-twometrics_graph(tickers=c("VFINX","SSO","UPRO"))
##End(Notrun)
vanguard_balanced_funds
VanguardBalancedMutualFundsandInceptionDates
Description
VanguardBalancedMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_bond_etfs
41
vanguard_bond_etfs
VanguardBondETFsandInceptionDates
Description
VanguardBondETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_bond_funds
VanguardBondMutualFunds
Description
VanguardBondMutualFunds
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_etfs
VanguardETFsandInceptionDates
Description
VanguardETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_funds
VanguardMutualFundsandInceptionDates
Description
VanguardMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
42
vanguard_international_etfs
vanguard_igrade_etfs
VanguardInvestment-gradeBondETFsandInceptionDates
Description
VanguardInvestment-gradeBondETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_igrade_funds
VanguardInvestment-gradeBondMutualFundsandInceptionDates
Description
VanguardInvestment-gradeBondMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_international_etfs
VanguardInternationalETFsandInceptionDates
Description
VanguardInternationalETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_international_funds
43
vanguard_international_funds
VanguardInternationalMutualFundsandInceptionDates
Description
VanguardInternationalMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_largecap_etfs
VanguardLarge-capStockETFsandInceptionDates
Description
VanguardLarge-capStockETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_largecap_funds
VanguardLarge-capStockMutualFundsandInceptionDates
Description
VanguardLarge-capStockMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
44
vanguard_sector_funds
vanguard_midcap_etfs
VanguardMid-capStockETFsandInceptionDates
Description
VanguardMid-capStockETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_midcap_funds
VanguardMid-capStockMutualFundsandInceptionDates
Description
VanguardMid-capStockMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_sector_etfs
VanguardSector&SpecialtyETFsandInceptionDates
Description
VanguardSector&SpecialtyETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_sector_funds
VanguardSectorMutualFundsandInceptionDates
Description
VanguardSectorMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_smallcap_etfs
45
vanguard_smallcap_etfs
VanguardSmall-capStockETFsandInceptionDates
Description
VanguardSmall-capStockETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_smallcap_funds
VanguardSmall-capStockMutualFundsandInceptionDates
Description
VanguardSmall-capStockMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_stock_etfs
VanguardStockETFsandInceptionDates
Description
VanguardStockETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
46
vanguard_targetrisk_funds
vanguard_stock_funds
VanguardStockMutualFundsandInceptionDates
Description
VanguardStockMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_targetdate_funds
VanguardTargetDateMutualFunds
Description
VanguardTargetDateMutualFunds
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_targetrisk_funds
VanguardTargetRiskMutualFundsandInceptionDates
Description
VanguardTargetRiskMutualFundsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_taxexempt_bond_funds
47
vanguard_taxexempt_bond_funds
VanguardTax-exemptBondMutualFundsandInceptionDates
Description
VanguardTax-exemptBondMutualFundsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_traditional_funds
VanguardTraditionalMutualFundsandInceptionDates
Description
VanguardTraditionalMutualFundsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_treasury_etfs
VanguardTreasury/AgencyBondETFsandInceptionDates
Description
VanguardTreasury/AgencyBondETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
48
vanguard_treasury_funds
vanguard_treasury_funds
VanguardTreasury/AgencyBondMutualFundsandInceptionDates
Description
VanguardTreasury/AgencyBondMutualFundsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
Index
axis
,
19
beta_trailing50
,
3
bmp
,
10
,
13
,
20
,
21
,
35
,
38
,
40
contango_hedged
,
4
contango_simple
,
5
convert_gain
,
7
daily_yearly
,
8
diff
,
8
diffs
,
8
gains_graph
,
9
gains_prices
,
10
gains_rate
,
11
grid
,
13
growth_graph
,
12
highyield_etfs
,
13
jpeg
,
10
,
13
,
20
,
21
,
35
,
38
,
40
largest_etfs
,
14
legend
,
10
,
13
,
21
lm
,
10
load_gains
,
3
,
5
,
6
,
9
,
12
,
14
,
18
,
19
,
21
,
30
,
31
,
33
,
37
,
39
load_prices
,
15
mdd
,
17
metrics
,
18
onemetric_graph
,
19
onemetric_overtime_graph
,
20
pchanges
,
22
pdf
,
10
,
13
,
20
,
21
,
35
,
38
,
40
pdiffs
,
23
plot
,
10
,
13
,
19
,
21
,
34
,
38
,
40
png
,
10
,
13
,
20
,
21
,
35
,
38
,
40
points
,
10
,
13
,
19
,
21
,
34
,
38
,
40
prices_gains
,
23
prices_rate
,
24
ratios
,
25
rrr
,
26
sector_spdr_etfs
,
27
sharpe
,
27
sortino
,
28
stocks
,
28
stocks-package
(
stocks
)
,
28
targetall
,
29
targetbeta_twofunds
,
30
text
,
35
,
38
,
40
threefunds_graph
,
33
ticker_dates
,
35
tiff
,
10
,
13
,
20
,
21
,
35
,
38
,
40
twofunds_graph
,
36
twometrics_graph
,
39
vanguard_balanced_funds
,
40
vanguard_bond_etfs
,
41
vanguard_bond_funds
,
41
vanguard_etfs
,
41
vanguard_funds
,
41
vanguard_igrade_etfs
,
42
vanguard_igrade_funds
,
42
vanguard_international_etfs
,
42
vanguard_international_funds
,
43
vanguard_largecap_etfs
,
43
vanguard_largecap_funds
,
43
vanguard_midcap_etfs
,
44
vanguard_midcap_funds
,
44
vanguard_sector_etfs
,
44
vanguard_sector_funds
,
44
vanguard_smallcap_etfs
,
45
vanguard_smallcap_funds
,
45
vanguard_stock_etfs
,
45
49
50
INDEX
vanguard_stock_funds
,
46
vanguard_targetdate_funds
,
46
vanguard_targetrisk_funds
,
46
vanguard_taxexempt_bond_funds
,
47
vanguard_traditional_funds
,
47
vanguard_treasury_etfs
,
47
vanguard_treasury_funds
,
48
Package`stocks'
August31,2018
Type
Package
Title
StockMarketAnalysis
Version
1.1.4
License
GPL-3
Date
2018-08-30
Author
DaneR.VanDomelen
Maintainer
DaneR.VanDomelen
<vandomed@gmail.com>
Description
Functionsforanalyzingstocksorotherinvestments.Mainfeaturesareloadingandalign-
inghistoricaldatafortickersymbols,calculatingperformancemetricsforindivid-
ualfundsorportfolios(e.g.annualizedgrowth,maximumdrawdown,Sharpe/Sortinora-
tio),andcreatinggraphs.C++codeisusedtoimproveprocessingspeedwherepossible.
Depends
rbenchmark,quantmod
Imports
dvmisc,graphics,grDevices,Hmisc,lubridate,methods,
RColorBrewer,Rcpp(>=0.12.15),stats,TTR,zoo
Suggests
knitr,rmarkdown,pander,printr
LinkingTo
Rcpp
RoxygenNote
6.0.1
NeedsCompilation
yes
Repository
CRAN
Date/Publication
2018-08-3104:30:03UTC
R
topicsdocumented:
beta_trailing50.......................................
3
contango_hedged......................................
4
contango_simple......................................
5
convert_gain.........................................
7
daily_yearly.........................................
8
diffs.............................................
8
gains_graph.........................................
9
gains_prices.........................................
10
1
*****page brek******2
R
topicsdocumented:
gains_rate..........................................
11
growth_graph........................................
12
highyield_etfs........................................
13
largest_etfs.........................................
14
load_gains..........................................
14
load_prices.........................................
15
mdd.............................................
17
metrics............................................
18
onemetric_graph......................................
19
onemetric_overtime_graph.................................
20
pchanges..........................................
22
pdiffs............................................
23
prices_gains.........................................
23
prices_rate..........................................
24
ratios............................................
25
rrr..............................................
26
sector_spdr_etfs.......................................
27
sharpe............................................
27
sortino............................................
28
stocks............................................
28
targetall...........................................
29
targetbeta_twofunds.....................................
30
threefunds_graph......................................
33
ticker_dates.........................................
35
twofunds_graph.......................................
36
twometrics_graph......................................
39
vanguard_balanced_funds.................................
40
vanguard_bond_etfs.....................................
41
vanguard_bond_funds....................................
41
vanguard_etfs........................................
41
vanguard_funds.......................................
41
vanguard_igrade_etfs....................................
42
vanguard_igrade_funds...................................
42
vanguard_international_etfs.................................
42
vanguard_international_funds...............................
43
vanguard_largecap_etfs...................................
43
vanguard_largecap_funds..................................
43
vanguard_midcap_etfs...................................
44
vanguard_midcap_funds..................................
44
vanguard_sector_etfs....................................
44
vanguard_sector_funds...................................
44
vanguard_smallcap_etfs...................................
45
vanguard_smallcap_funds.................................
45
vanguard_stock_etfs....................................
45
vanguard_stock_funds...................................
46
vanguard_targetdate_funds.................................
46
vanguard_targetrisk_funds.................................
46
vanguard_taxexempt_bond_funds.............................
47
*****page brek******beta_trailing50
3
vanguard_traditional_funds.................................
47
vanguard_treasury_etfs...................................
47
vanguard_treasury_funds..................................
48
Index
49
beta_trailing50
BetaforLast50DailyGains
Description
Calculatesbetaforatickersymbolbasedontheprevious50dailygains.
Usage
beta_trailing50(ticker,bench="SPY",...)
Arguments
ticker
CharacterstringwithtickersymbolsthatYahoo!Financerecognizes.
bench
Characterstringwithtickersymbolforbenchmark.
...
Argumentstopassto
load_gains
.
Value
Numericvalue.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#CalculateTLT
'
sbetabasedontheprevious50dailygains
beta_trailing50("TLT")
##End(Notrun)
*****page brek******4
contango_hedged
contango_hedged
BacktestaHedgedContango-BasedVolatilityTradingStrategy
Description
Implementsthefollowingstrategy:Eachday,holdXIV/SPXU(weightedforzerobeta)ifcontango
>
xiv.spxu.cutpoint
,holdVXX/UPRO(weightedforzerobeta)ifcontango<
vxx.upro.cutpoint
,
andholdcashotherwise.PerhapsnotveryusefulsinceXIVclosedonFeb.20,2018.
Usage
contango_hedged(contango,xiv.spxu.gains=NULL,vxx.upro.gains=NULL,
xiv.spxu.cutpoint=6.36,vxx.upro.cutpoint=5.45,
xiv.allocation=0.46,vxx.allocation=0.46,xiv.beta=NULL,
vxx.beta=NULL,initial=10000)
Arguments
contango
Numericvectorofcontangovaluesattheendofeachtradingday.
xiv.spxu.gains
2-columnnumericmatrixwithgainsforXIVandSPXU.Shouldhavethesame
numberofrowsas
contango
andbedate-shiftedonevaluetotheright.For
example,therowshouldhavetheXIVandSPXUgainsforthedayAFTER
thecontangovalue.
vxx.upro.gains
2-columnnumericmatrixwithgainsforVXXandUPRO.Shouldhavethesame
numberofrowsas
contango
andbedate-shiftedonevaluetotheright.For
example,therowshouldhavetheVXXandUPROgainsforthedayAFTER
thecontangovalue.
xiv.spxu.cutpoint
NumericvaluegivingthecontangocutpointforXIV/SPXUposition.Forexam-
ple,if
xiv.spxu.cutpoint=5
,XIV/SPXUwillbeheldwhenevercontango
isgreaterthan5%.
vxx.upro.cutpoint
NumericvaluegivingthecontangocutpointforVXX/UPROposition.Forex-
ample,if
vxx.upro.cutpoint=-5
,VXX/UPROwillbeheldwhenevercon-
tangoislessthan-5%.
xiv.allocation
NumericvaluespecifyingXIVallocationforXIV/SPXUposition.Forexample,
ifsetto0.46,46%isallocatedtoXIVand54%toSPXUwhencontango>
xiv.spxu.cutpoint
.
vxx.allocation
NumericvaluespecifyingVXXallocationforVXX/UPROposition.Forexam-
ple,ifsetto0.46,46%isallocatedtoVXXand54%toUPROwhencontango
<
vxx.upro.cutpoint
.
xiv.beta
NumericvaluespecifyingXIV'sbeta.Ifspecithefunctionoutwhat
xiv.allocation
needstobeforzero-betaXIV/SPXUpositions.Forexample,
ifsetto3.5,then46.2%XIV/53.8%SPXUachieveszerobeta.
*****page brek******contango_simple
5
vxx.beta
NumericvalueindicatingVXX'sbeta.Ifthefunctionoutwhat
vxx.allocation
needstobeforzero-betaVXX/UPROpositions.Forexample,
ifsetto-3.5,then46.2%VXX/53.8%UPROachieveszerobeta.
initial
Numericvaluegivingtheinitialvalueoftheportfolio.
Details
YoucanhistoricalcontangovaluesfromTheIntelligentInvestorBlog.Youcanclickthe
linkat
http://investing.kuchita.com/2012/06/28/xiv-data-and-pricing-model-since-vix-futures-available-2004/
todownloadazipcontaininganExcelspreadsheet.Then,youwillneedtocalculatewhatever
versionof"contango"youprefer.Itypicallycontangoaswhatpercenthigherthesecond-
monthVIXfuturesareacomparedtothefutures,i.e.dividingthe"2ndmth"columnby
the"1stmth"column,subtracting1,andthenmultiplyingby100.
ToloaddailygainsforXIV,SPXU,VXX,andUPRO,youcanuse
load_gains
,whichusesthe
quantmod
packagetoloaddatafromYahoo!Finance.Youwillhavetospecifythe
from
and
to
inputstomatchthedaterangeforyourcontangovalues.
Value
Listcontaining:
1.
Charactervectornamed
holdings
indicatingwhatfundwasheldeachday(XIV/SPXU,
VXX/UPRO,orcash).
2.
Numericvectornamed
port.gains
givingtheportfoliogainforeachday,whichwillbe0for
daysthatcashwasheldandtheweightedXIV/SPXUorVXX/UPROgainfordaysthatone
ofthosepositionswasheld.
3.
Numericvectornamed
port.balances
givingtheportfoliobalanceeachday.
4.
Numericvaluenamed
trades
givingthetotalnumberoftradesexecuted.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
contango_simple
BacktestaSimpleContango-BasedVolatilityTradingStrategy
Description
Simplestrategy:Eachday,holdXIVifcontango>
xiv.cutpoint
,holdVXXifcontango<
vxx.cutpoint
,andholdcashotherwise.PerhapsnotveryusefulsinceXIVclosedonFeb.20,
2018.
Usage
contango_simple(contango,xiv.gains=NULL,vxx.gains=NULL,
xiv.cutpoint=0,vxx.cutpoint=-Inf,initial=10000)
*****page brek******6
contango_simple
Arguments
contango
Numericvectorofcontangovaluesattheendofeachtradingday.
xiv.gains
NumericvectorofgainsforXIV.Shouldbesamelengthas
contango
anddate-
shiftedonevaluetotheright.Forexample,thevalueof
xiv.gains
should
betheXIVgainforthedayAFTERthecontangovalue.
vxx.gains
NumericvectorofgainsforVXX.Shouldbesamelengthas
contango
anddate-
shiftedonevaluetotheright.Forexample,thevalueof
vxx.gains
should
betheVXXgainforthedayAFTERthecontangovalue.
xiv.cutpoint
NumericvaluegivingthecontangocutpointforXIV,inpercent.
vxx.cutpoint
NumericvaluegivingthecontangocutpointforVXX,inpercent.
initial
Numericvaluegivingtheinitialvalueoftheportfolio.
Details
YoucanhistoricalcontangovaluesfromTheIntelligentInvestorBlog.Youcanclickthe
linkat
http://investing.kuchita.com/2012/06/28/xiv-data-and-pricing-model-since-vix-futures-available-2004/
todownloadazipcontaininganExcelspreadsheet.Then,youwillneedtocalculatewhatever
versionof"contango"youprefer.Itypicallycontangoaswhatpercenthigherthesecond-
monthVIXfuturesareacomparedtothefutures,i.e.dividingthe"2ndmth"columnby
the"1stmth"column,subtracting1,andthenmultiplyingby100.
Ithinkthemostcommonapproachforcontango-basedvolatilitystrategiesisholdingXIV(inverse
volatility)whencontangoisabovesomevalue(e.g.0%,5%,or10%),andholdingcashotherwise.
Youcandothatwiththisfunctionbyleaving
vxx.cutpoint
as
-Inf
.However,youmayalsowant
toholdVXX(volatility)whencontangoisbelowsomevalue(e.g.0%,-5%,-10%),alsoknownas
"backwardation".YoucanimplementanXIV-only,VXX-only,orXIVandVXXstrategywiththis
function.
ToloaddailygainsforXIVand/orVXX,youcanuse
load_gains
,whichusesthe
quantmod
package[1]toloaddatafromYahoo!Finance.Youwillhavetospecifythe
from
and
to
inputsto
matchthedaterangeforyourcontangovalues.
Value
Listcontaining:
1.
Charactervectornamed
holdings
indicatingwhatfundwasheldeachday(XIV,VXX,or
cash).
2.
Numericvectornamed
port.gains
givingtheportfoliogainforeachday,whichwillbe0for
daysthatcashwasheldandtheXIVorVXXgainfordaysthatXIVorVXXwasheld.
3.
Numericvectornamed
port.balances
givingtheportfoliobalanceeachday.
4.
Numericvaluenamed
trades
givingthetotalnumberoftradesexecuted.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
*****page brek******convert_gain
7
convert_gain
ConvertGainfromOneTimeIntervaltoAnother
Description
Forexample,youcanusethisfunctiontooutthatan8tradingdaysis31.9
Usage
convert_gain(gain,units.in=1,units.out=1)
Arguments
gain
Numericvaluespecifyingagain,e.g.0.005for0.5avectorofgains.
units.in
Numericvaluegvingthetimeperiodoverwhichthegainwasachieved.
units.out
Numericvaluegivingthetimeperiodyouwanttoconvertto.
Value
Numericvalueorvector.
Examples
#Calculateannualizedgainforan8%gainovera70-dayperiod
convert_gain(gain=0.08,units.in=70,units.out=252)
#Calculatetheannualgrowthrateofafundthatgains0.02%perday
convert_gain(gain=0.0002,units.in=1,units.out=252)
#Calculatetheannualgrowthrateofafundthatgains1%perweek
convert_gain(gain=0.01,units.in=1,units.out=52)
#YouinvestinAAPLandgain0.5%in17businessdays.Expressasa5-year
#growthrate.
convert_gain(gain=0.005,units.in=17,units.out=252*5)
#Yourportfoliohastripledina13-yearperiod.Calculateyouraverage
#annualgain.
convert_gain(gain=2,units.in=13,units.out=1)
*****page brek******8
diffs
daily_yearly
ConvertDailyGaintoX-yearGain
Description
Forexample,youcanusethisfunctiontocalculatethataninvestmentthatgains0.1days).
Usage
daily_yearly(gain,years=1)
Arguments
gain
Numericvaluespecifyingagain,e.g.0.005for0.5avectorofgains.
years
Numericvalue.
Value
Numericvalueorvector.
Examples
#Calculateannualgainforaninvestmentthatgains0.1%perday
daily_yearly(gain=0.001)
#Calculate5-yeargainscorrespondingtovariousdailygains
daily_yearly(gain=seq(0,0.001,0.0001),years=5)
diffs
LaggedDifferences(AlternateImplementation)
Description
Calculatesdifferencesbetweensubsequent(orlagged)elementsofavector.Verysimilarto
diff
,
butwritteninC++.
Usage
diffs(x,lag=1L)
Arguments
x
Numericvector.
lag
Numericvalue(e.g.2fordifferencesbetween1stand3rdelement,2ndand4th,
...).
*****page brek******gains_graph
9
Value
Numericvector.
Examples
#Generate1millionvaluesfromPoisson(3)distribution
x<-rpois(100000,3)
#Calculatevectorofdifferencesbetweensubsequentvalues
y<-diffs(x)
#CouldgetsameresultfrombaseRfunctiondiff
z<-diff(x)
all.equal(y,z)
#Butdiffsisfaster
benchmark(diffs(x),diff(x),replications=100)
gains_graph
ScatterplotofInvestmentGains
Description
Usefulforvisualizingrelationshipbetweenone(orseveral)investmentsandabenchmark.First
fundin
tickers
,
gains
,or
prices
isusedasthebenchmark.
Usage
gains_graph(tickers=NULL,...,gains=NULL,prices=NULL,
orders=1,add.plot=FALSE,include.legend=TRUE,colors=NULL,
lty=NULL,plot.list=NULL,points.list=NULL,legend.list=NULL,
pdf.list=NULL,bmp.list=NULL,jpeg.list=NULL,png.list=NULL,
tiff.list=NULL)
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
...
Argumentstopassalongwith
tickers
to
load_gains
.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
*****page brek******10
gains_prices
orders
Numericvectorspecifyingtheordersoflinearregressionmodelsforeachy-
axisinvestment.Setto
1
forsimplelinearregression,
2
forlinearregression
withandsecond-orderterms,andsoon.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
include.legend
Logicalvalue.
colors
Charactervectorofcolorsforeachcurve.
lty
Numericvectorspecifyinglinetypesforeachcurve.
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
legend.list
Listofargumentstopassto
legend
.
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,alistcontaininglinearregressionmodelsreturnedby
lm
foreach
investmentvs.thebenchmark.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#PlotdailygainsforSSOandUPROvs.VFINX
fig<-gains_graph(c("VFINX","SSO","UPRO"))
##End(Notrun)
gains_prices
ConvertGainstoPrices
Description
Calculatespricesbasedoninitialbalanceandvectorofgains.
*****page brek******gains_rate
11
Usage
gains_prices(gains,initial=10000)
Arguments
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
initial
Numericvalue.
Value
Numericvalueif
gains
isavector,numericmatrixif
gains
isamatrix.
Examples
#Simulatedailygainsovera5-yearperiod
set.seed(123)
gains<-rnorm(n=252*5,mean=0.001,sd=0.02)
#Plotbalanceovertimeifinitialbalanceis$10,000
prices<-gains_prices(gains)
plot(prices)
gains_rate
CalculateGrowthRateFromaVectorofGains
Description
Theformulaissimply:
prod(gains+1)-1
.If
units.rate
isthenitconvertsto
x-unitgrowthrate.
Usage
gains_rate(gains,units.rate=NULL)
Arguments
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
units.rate
Numericvaluespecifyingthenumberofunitsforgrowthratecalculation,ifyou
wantsomethingotherthantotalgrowth.Forannualizedgrowthrate,setto252
if
gains
hasdailygains,12if
gains
hasmonthlygains,etc.
Value
Numericvalueif
gains
isavector,numericmatrixif
gains
isamatrix.
*****page brek******12
growth_graph
Examples
#Createvectorofdailygainsforahypotheticalstock
daily.gains<-c(-0.02,-0.01,0.01,0.02,0.01)
#Overallgrowthis0.95%
gains_rate(daily.gains)
#Averagedailygrowthis0.19%
gains_rate(daily.gains,1)
#Correspondsto61.0%annualgrowth
gains_rate(daily.gains,252)
growth_graph
GraphInvestmentGrowth
Description
Usefulforcomparingperformanceofinvestmentsovertime.
Usage
growth_graph(tickers=NULL,...,gains=NULL,prices=NULL,
initial="10k",add.plot=FALSE,colors=NULL,lty=NULL,
plot.list=NULL,points.list=NULL,grid.list=NULL,
legend.list=NULL,pdf.list=NULL,bmp.list=NULL,
jpeg.list=NULL,png.list=NULL,tiff.list=NULL)
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
...
Argumentstopassalongwith
tickers
to
load_gains
.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
initial
Numericvaluespecifyingwhatvaluetoscaleinitialpricesto.Canalsobechar-
acterstringendingin"k",e.g.
"10k"
tographgrowthof$10kwithoutallthe
0's.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
colors
Charactervectorofcolorsforeachcurve.
lty
Numericvectorspecifyinglinetypesforeachcurve.
*****page brek******highyield_etfs
13
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
grid.list
Listofargumentstopassto
grid
.
legend.list
Listofargumentstopassto
legend
.
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,alistcontaining:
1.
Numericmatrixnamed
prices
withpricesforeachinvestment.
2.
Numericvectornamed
means
withmeanofgainsforeachinvestment.
3.
Numericmatrixnamed
corr.matrix
withcorrelationmatrixforgainsforeachinvestment.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#Plotgrowthof$10kinVFINXandBRK-B
fig<-growth_graph(c("VFINX","BRK-B"))
##End(Notrun)
highyield_etfs
High-YieldETFsfromETFdb.comandInceptionDates
Description
High-YieldETFsfromETFdb.comandInceptionDates
Source
http://etfdb.com/etfdb-category/high-yield-bonds/#etfs&sort_name=assets_under_management&
sort_order=desc&page=2
*****page brek******14
load_gains
largest_etfs
Largest100MarketCapETFs(asof3/2/18)andInceptionDates
Description
Largest100MarketCapETFs(asof3/2/18)andInceptionDates
Source
http://etfdb.com/compare/market-cap/
load_gains
DownloadandAlignGainsforaSetofTickers
Description
DownloadsandalignshistoricalinvestmentgainsfortickersfromYahoo!Finance,using
the
quantmod
package.
Usage
load_gains(tickers,intercepts=NULL,slopes=NULL,from="1950-01-01",
to=Sys.Date(),time.scale="daily",preto.days=NULL,
prefrom.days=NULL,earliest=FALSE,latest=FALSE)
Arguments
tickers
CharactervectorwithtickersymbolsthatYahoo!Financerecognizes.
intercepts
Numericvectorofvaluestoaddtodailygainsforeachticker.
slopes
Numericvectorofvaluestomultiplydailygainsforeachtickerby.Slopesare
multipliedpriortoaddingintercepts.
from
Dateorcharacterstring(e.g.
"2015-01-15"
.
to
Dateorcharacterstring(e.g.
"2016-01-30"
).
time.scale
Characterstringcontrollingtimeframeforgains.Choicesare
"daily"
,
"monthly"
,
and
"yearly"
.
preto.days
Numericvalue.Ifspecifunctionreturnsgainsfor
preto.days
tradingdays
priorto
to
.Toillustrate,toloadthemostrecent50dailygains,youwouldleave
to
and
time.scale
asthedefaultsandset
preto.days=50
.
prefrom.days
Numericvalue.Iffunctionreturnsgainsfor
prefrom.days
trading
dayspriorto
from
.Usefulwhenyouwanttotestatradingstrategystartingona
particulardate,butthestrategyrequiresdataleadinguptothatdate(e.g.trailing
beta).
*****page brek******load_prices
15
earliest
Logicalvalueforwhethertoretainonlythesubsetoftickerswithdatagoingthe
furthestback.Setto
FALSE
ifyouwantalltickersretainedandgainsovertheir
mutuallifetimes.
latest
Logicalvalueforwhethertoretainonlythesubsetoftickerswithdatagoingthe
furthestforward,e.g.droppingfundsthatwerediscontinuedatsomepoint.
Details
Inaligninghistoricalprices,datesonwhichnotallfundshavedataaresimplydropped.Messages
areprintedindicatingwhichdatesaredroppedforwhichtickers.
Value
Numericmatrix.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#LoadgainsforNetflixandAmazonovertheirmutuallifetimes
gains<-load_gains(c("NFLX","AMZN"))
##End(Notrun)
load_prices
DownloadandAlignHistoricalPricesforaSetofTickers
Description
DownloadsandalignshistoricalpricesfortickersfromYahoo!Finance,usingthe
quant-
mod
package.
Usage
load_prices(tickers,intercepts=NULL,slopes=NULL,
from="1950-01-01",to=Sys.Date(),time.scale="daily",
preto.days=NULL,prefrom.days=NULL,initial=NULL,
earliest=FALSE,latest=FALSE)
*****page brek******16
load_prices
Arguments
tickers
CharactervectorwithtickersymbolsthatYahoo!Financerecognizes.
intercepts
Numericvectorofvaluestoaddtodailygainsforeachticker.
slopes
Numericvectorofvaluestomultiplydailygainsforeachtickerby.Slopesare
multipliedpriortoaddingintercepts.
from
Dateorcharacterstring(e.g.
"2015-01-15"
.
to
Dateorcharacterstring(e.g.
"2016-01-30"
).
time.scale
Characterstringcontrollingtimeframeforgains.Choicesare
"daily"
,
"monthly"
,
and
"yearly"
.
preto.days
Numericvalue.Ifspecifunctionreturnsgainsfor
preto.days
tradingdays
priorto
to
.Toillustrate,toloadthemostrecent50dailygains,youwouldleave
to
and
time.scale
asthedefaultsandset
preto.days=50
.
prefrom.days
Numericvalue.Iffunctionreturnsgainsfor
prefrom.days
trading
dayspriorto
from
.Usefulwhenyouwanttotestatradingstrategystartingona
particulardate,butthestrategyrequiresdataleadinguptothatdate(e.g.trailing
beta).
initial
Numericvaluespecifyingwhatvaluetoscaleinitialpricesto.
earliest
Logicalvalueforwhethertoretainonlythesubsetoftickerswithdatagoingthe
furthestback.Setto
FALSE
ifyouwantalltickersretainedandgainsovertheir
mutuallifetimes.
latest
Logicalvalueforwhethertoretainonlythesubsetoftickerswithdatagoingthe
furthestforward,e.g.droppingfundsthatwerediscontinuedatsomepoint.
Details
Inaligninghistoricalprices,datesonwhichnotallfundshavedataaresimplydropped.Messages
areprintedindicatingwhichdatesaredroppedforwhichtickers.
Value
Numericmatrix.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#LoadpricesforNetflixandAmazonovertheirmutuallifetimes
prices<-load_prices(c("NFLX","AMZN"))
##End(Notrun)
*****page brek******mdd
17
mdd
MaximumDrawdown
Description
Calculatesmaximumdrawdownfromvectorofclosingprices,highsandlows,orgains.
Usage
mdd(prices=NULL,highs=NULL,lows=NULL,gains=NULL,
indices=FALSE)
Arguments
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
highs
Numericvectorofdailyhighprices.
lows
Numericvectorofdailylowprices.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
indices
Logicalvalueforwhethertoincludeindicesforwhenthemaximumdrawdown
occurred.
Value
Numericvalue,vector,ormatrixdependingon
indices
andwhetherthereis1fundorseveral.
Examples
##Notrun:
#Simulateminute-to-minutestockgainsovera2-yearperiod
set.seed(123)
stock.gains<-rnorm(6.5*60*252*2,0.000005,0.001)
#Converttostockpricesassuminganinitialpriceof$9.50pershare
stock.prices<-gains_prices(gains=stock.gains,initial=9.50)
#Plotminute-to-minutestockprices(200kdatapoint,maybeslow)
plot(stock.prices)
#Maximumdrawdownbasedonstockprices
mdd(prices=stock.prices)
#Sameanswerusinggainsratherthanprices
mdd(gains=stock.gains)
##End(Notrun)
*****page brek******18
metrics
metrics
CalculateVariousPerformanceMetrics
Description
Usefulforcomparingmetricsforseveralinvestments.Theinvestmentisusedasthebenchmark
ifrequestedmetricsrequireone.
Usage
metrics(tickers=NULL,...,gains=NULL,prices=NULL,
perf.metrics=c("mean","sd","growth","cagr","mdd","sharpe","sortino",
"alpha","beta","r.squared","pearson","spearman","auto.pearson",
"auto.spearman"))
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
...
Argumentstopassalongwith
tickers
to
load_gains
.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
perf.metrics
Charactervectorspecifyingmetricstocalculate.
Value
Listcontaining:
1.
Numericmatrixnamed
perf.metrics
withperformancemetrics.
2.
Numericmatrixnamed
cor.mat
withcorrelationmatrixforgainsforthevariousinvestments.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#CalculateperformancemetricsforSSOandUPRO,usingSPYasbenchmark
#foralphaandbeta
metrics1<-metrics(tickers=c("SPY","SSO","UPRO"))
##End(Notrun)
*****page brek******onemetric_graph
19
onemetric_graph
GraphPerformanceMetricforVariousInvestments
Description
Usefulforvisualizingtheperformanceofagroupofinvestments.Theinvestmentisusedas
thebenchmarkiftherequestedmetricrequiresone.
Usage
onemetric_graph(tickers=NULL,...,gains=NULL,prices=NULL,
y.metric="cagr",add.plot=FALSE,sort.tickers=TRUE,
plot.list=NULL,points.list=NULL,axis.list=NULL,
pdf.list=NULL,bmp.list=NULL,jpeg.list=NULL,png.list=NULL,
tiff.list=NULL)
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
...
Argumentstopassalongwith
tickers
to
load_gains
.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
y.metric
Characterstringspecifyingy-axisperformancemetric.Choicesare:
"mean"
or
"sd"
formeanorstandarddeviationofgains.
"growth"
or
"cagr"
fortotalorannualizedgrowth.
"mdd"
formaximumdrawdown.
"sharpe"
or
"sortino"
forSharpeorSortinoratio.
"alpha"
,
"beta"
,or
"r.squared"
forthosemetricsfromalinearregres-
siononbenchmarkfund.
"pearson"
or
"spearman"
forPearsonorSpearmancorrelationwithbenchmark
fund.
"auto.pearson"
or
"auto.spearman"
forPearsonorSpearmanautocorrela-
tion,asthecorrelationbetweensubsequentgains.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
sort.tickers
Logicalvalueforwhethertosortinvestmentsindecreasingorderoftheperfor-
mancemetric.
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
axis.list
Listofargumentstopassto
axis
.
*****page brek******20
onemetric_overtime_graph
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,adataframecontainingtheperformancemetricforeachinvestment.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#CompareannualizedgrowthforVFINX,SSO,andUPRO
fig<-onemetric_graph(tickers=c("VFINX","SSO","UPRO"),
plot.list=list(ylim=c(0,50)))
##End(Notrun)
onemetric_overtime_graph
GraphPerformanceMetricOverTimeforVariousInvestments
Description
Usefulforvisualizingtheperformanceofagroupofinvestmentsovertime.Theinvestmentis
usedasthebenchmarkiftherequestedmetricrequiresone.
Usage
onemetric_overtime_graph(tickers=NULL,...,gains=NULL,prices=NULL,
y.metric="cagr",window.units=50,add.plot=FALSE,colors=NULL,
lty=NULL,plot.list=NULL,points.list=NULL,legend.list=NULL,
pdf.list=NULL,bmp.list=NULL,jpeg.list=NULL,png.list=NULL,
tiff.list=NULL)
*****page brek******onemetric_overtime_graph
21
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
...
Argumentstopassalongwith
tickers
to
load_gains
.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
y.metric
Characterstringspecifyingy-axisperformancemetric.Choicesare:
"mean"
or
"sd"
formeanorstandarddeviationofgains.
"growth"
or
"cagr"
fortotalorannualizedgrowth.
"mdd"
formaximumdrawdown.
"sharpe"
or
"sortino"
forSharpeorSortinoratio.
"alpha"
,
"beta"
,or
"r.squared"
forthosemetricsfromalinearregres-
siononbenchmarkfund.
"pearson"
or
"spearman"
forPearsonorSpearmancorrelationwithbenchmark
fund.
"auto.pearson"
or
"auto.spearman"
forPearsonorSpearmanautocorrela-
tion,asthecorrelationbetweensubsequentgains.
window.units
Numericvaluespecifyingthewidthofthemovingwindow.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
colors
Charactervectorofcolorsforeachcurve.
lty
Numericvectorspecifyinglinetypesforeachcurve.
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
legend.list
Listofargumentstopassto
legend
.
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,anumericmatrixcontainingtheperformancemetricovertimeforeach
investment.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
*****page brek******22
pchanges
Examples
##Notrun:
#PlotBRK-B
'
s50-dayalphaovertimesincethestartof2016
fig<-onemetric_overtime_graph(tickers=c("VFINX","BRK-B"),
y.metric="alpha",
from="2016-01-01")
##End(Notrun)
pchanges
LaggedProportionChanges
Description
Calculatesproportionchangesbetweensubsequent(orlagged)elementsofavector.
Usage
pchanges(x,lag=1L)
Arguments
x
Numericvector.
lag
Numericvalue(e.g.2fordifferencesbetween1stand3rdelement,2ndand4th,
...).
Value
Numericvector.
Examples
#Generate10valuesfromN(0,1)
x<-rnorm(10)
#Calculatevectorofproportionchangesbetweensubsequentvalues
(y<-pchanges(x))
#EquivalentbaseRcomputation
len<-length(x)
p1<-x[2:len]
p2<-x[1:(len-1)]
y2<-p1/p2-1
all.equal(y,y2)
*****page brek******pdiffs
23
pdiffs
LaggedProportionDifferences
Description
Calculatesproportiondifferencesbetweensubsequent(orlagged)elementsofavector.
Usage
pdiffs(x,lag=1L)
Arguments
x
Numericvector.
lag
Numericvalue(e.g.2fordifferencesbetween1stand3rdelement,2ndand4th,
...).
Value
Numericvector.
Examples
#Generate10valuesfromN(0,1)
x<-rnorm(10)
#Calculatevectorofproportiondifferencesbetweensubsequentvalues
(y<-pdiffs(x))
#EquivalentbaseRcomputation
len<-length(x)
p1<-x[2:len]
p2<-x[1:(len-1)]
y2<-(p1-p2)/(0.5*(p1+p2))
all.equal(y,y2)
prices_gains
ConvertPricestoGains
Description
Calculatesgainsbasedonvectorormatrixofprices.
*****page brek******24
prices_rate
Usage
prices_gains(prices)
Arguments
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
Value
Numericvectorormatrix.
Examples
##Notrun:
#Load2017pricesforNetflixandAmazon,andcalculategrowthof$10k
prices<-load_prices(c("NFLX","AMZN"),initial=1000)
#Calculategains
gains<-prices_gains(prices)
##End(Notrun)
prices_rate
CalculateGrowthRateFromaVectorofPrices
Description
Theformulaissimply:
prices[length(prices)]/prices[1]-1
.If
units.rate
is
thenitconvertstox-unitgrowthrate.
Usage
prices_rate(prices,units.rate=NULL)
Arguments
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
units.rate
Numericvaluespecifyingthenumberofunitsforgrowthratecalculation,ifyou
wantsomethingotherthantotalgrowth.Forannualizedgrowthrate,setto252
if
prices
hasdailyprices,12if
prices
hasmonthlyprices,etc.
Value
Numericvalueif
prices
isavector,numericmatrixif
prices
isamatrix.
*****page brek******ratios
25
Examples
#Createvectorofdailyclosingpricesforahypotheticalstock
prices<-c(100.4,98.7,101.3,101.0,100.9)
#Overallgrowthis0.50%
prices_rate(prices)
#Averagedailygrowthis0.12%
prices_rate(prices,1)
#Correspondsto36.7%annualizedgrowth
prices_rate(prices,252)
ratios
RatiosofSubsequentElementsinaVector
Description
Calculatesvectorofratiosofavector,i.e.ratioof
x[2]
to
x[1]
,ratioof
x[3]
to
x[2]
,andsoforth.
Usage
ratios(x)
Arguments
x
Numericvector.
Value
Numericvector.
Examples
#Generate10valuesfromN(0,1)
x<-rnorm(10)
#Calculatevectorofratios
(y<-ratios(x))
#SlowerbaseRcomputation
len<-length(x)
y2<-x[2:len]/x[1:(len-1)]
all.equal(y,y2)
*****page brek******26
rrr
rrr
Risk-ReturnRatio
Description
Calculatesrisk-returnratio,asgrowthratedividedbymaximumdrawdown.
Usage
rrr(prices=NULL,gains=NULL)
Arguments
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
Value
Numericvalueorvector.
Examples
#Simulatedailygainsovera5-yearperiod
set.seed(123)
stock.gains<-rnorm(252*5,0.0005,0.01)
#Converttodailybalancesassuminganinitialbalanceof$10,000
daily.balances<-gains_prices(stock.gains+1)
#Totalreturnisabout1.23
daily.balances[length(daily.balances)]/daily.balances[1]-1
#Maximumdrawdownisabout0.19
mdd(prices=daily.balances)
#Ratioofthesetwoisabout6.48
(daily.balances[length(daily.balances)]/daily.balances[1]-1)/
mdd(daily.balances)
#Easiertocalculateusingrrrfunction
rrr(daily.balances)
*****page brek******sector_spdr_etfs
27
sector_spdr_etfs
SectorSPDRETFsandInceptionDates
Description
SectorSPDRETFsandInceptionDates
Source
http://www.sectorspdr.com/sectorspdr/sectors/performance
sharpe
SharpeRatio
Description
CalculatesSharperatiofromvectorofgainsorprices.Theformulais:
(mean(gains)-rf)/sd(gains)
,
where
rf
issomerisk-freerateofreturn.
Usage
sharpe(gains=NULL,prices=NULL,rf=0)
Arguments
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
rf
Numericvalue.
Value
Numericvalue.
Examples
#Simulatedailygainsovera5-yearperiod
set.seed(123)
stock.gains<-rnorm(252*5,0.0005,0.01)
#CalculateSharperatiousingrisk-freereturnof0
sharpe(stock.gains)
*****page brek******28
stocks
sortino
SortinoRatio
Description
CalculatesSortinoratiofromvectorofgainsorprices.Theformulais:
(mean(gains)-rf)/sd(gains[gains<0])
,
where
rf
issomerisk-freerateofreturn.
Usage
sortino(gains=NULL,prices=NULL,rf=0)
Arguments
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
rf
Numericvalue.
Value
Numericvalueorvector.
Examples
#Simulatedailygainsovera5-yearperiod
set.seed(123)
stock.gains<-rnorm(252*5,0.0005,0.01)
#CalculateSortinoratiousingrisk-freereturnof0
sortino(stock.gains)
stocks
StockMarketAnalysis
Description
Functionsforanalyzingstocksorotherinvestments.Mainfeaturesareloadingandaligninghistor-
icaldatafortickersymbols,calculatingperformancemetricsforindividualfundsorportfolios(e.g.
annualizedgrowth,maximumdrawdown,Sharpe/Sortinoratio),andcreatinggraphs.C++codeis
usedtoimproveprocessingspeedwherepossible.
Details
*****page brek******targetall
29
Package:stocks
Type:Package
Version:1.1.4
Date:2018-08-30
License:GPL-3
See
CRANdocumentation
forfulllistoffunctionsandthe
GitHubpage
foranoverviewofthe
packagewithsomeexamples.
Author(s)
DaneR.VanDomelen
<vandomed@gmail.com>
References
Eddelbuettel,D.andFrancois,R.(2011)Rcpp:SeamlessRandC++Integration.JournalofStatis-
ticalSoftware,40(8),1-18.
http://www.jstatsoft.org/v40/i08/
.
Eddelbuettel,D.(2013)SeamlessRandC++IntegrationwithRcpp.Springer,NewYork.ISBN
978-1-4614-6867-7.
Eddelbuettel,D.andBalamuta,J.J.(2017).ExtendingRwithC++:ABriefIntroductiontoRcpp.
PeerJPreprints5:e3188v1.
https://doi.org/10.7287/peerj.preprints.3188v1
.
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Acknowledgment:ThismaterialisbaseduponworksupportedbytheNationalScienceFoundation
GraduateResearchFellowshipunderGrantNo.DGE-0940903.
targetall
BacktestaFixed-AllocationTradingStrategy
Description
Implementsatradingstrategyaimedatmaintainingaedallocationtoeachofseveralfunds,
rebalancingwhentheeffectiveallocationsdeviatetoofarfromthetargets.
Usage
targetall(tickers=NULL,intercepts=NULL,slopes=NULL,...,
tickers.gains=NULL,target.alls=NULL,tol=0.05,
rebalance.cost=0,initial=10000)
*****page brek******30
targetbeta_twofunds
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
intercepts
Numericvectorofvaluestoaddtodailygainsforeachticker.
slopes
Numericvectorofvaluestomultiplydailygainsforeachtickerby.Slopesare
multipliedpriortoaddingintercepts.
...
Argumentstopassalongwith
tickers
to
load_gains
.
tickers.gains
Numericmatrixofgains,whereeachcolumnhasgainsforaparticularfund.
target.alls
Numericvectorspecifyingtargetallocationstoeachfund.Ifequal
allocationsareused(e.g.1/3,1/3,1/3ifthereare3funds).
tol
Numericvalueindicatinghowfartheeffectiveallocationscandriftawayfrom
thetargetsbeforerebalancing.
rebalance.cost
Numericvaluespecifyingtotalcostofeachrebalancingtrade.
initial
Numericvaluespecifyingwhatvaluetoscaleinitialpricesto.
Value
Listcontaining:
1.
Numericmatrixnamed
fund.balances
givingfundbalancesovertime.
2.
Numericvaluenamed
rebalance.count
givingthenumberofrebalancingtradesexecuted.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#Backtestequal-allocationUPRO/VBLTX/VWEHXstrategy
port<-targetall(tickers=c("UPRO","VBLTX","VWEHX"))
plot(port$fund.balances[,"Portfolio"])
##End(Notrun)
targetbeta_twofunds
BacktestaTwo-FundStrategythatTargetsaCertainBeta
Description
Implementsatwo-fundstrategywhereallocationstoeachfundareadjustedtomaintainsome
userportfoliobeta.Forexample,youcouldback-testazero-beta(i.e.marketneutral)
UPRO/VBLTXstrategyusingthisfunction.
*****page brek******targetbeta_twofunds
31
Usage
targetbeta_twofunds(tickers=NULL,intercepts=NULL,slopes=NULL,...,
benchmark.ticker=NULL,reference.tickers=NULL,tickers.gains=NULL,
benchmark.gains=NULL,reference.gains=NULL,target.beta=0,
tol=0.15,window.units=50,failure.method="closer",
maxall.tol=tol-0.05,initial=10000)
Arguments
tickers
Charactervectorspecifying2tickersymbolsthatYahoo!Financerecognizes,if
youwanttodownloaddataonthe.
intercepts
Numericvectorofvaluestoaddtodailygainsforeachticker.
slopes
Numericvectorofvaluestomultiplydailygainsforeachtickerby.Slopesare
multipliedpriortoaddingintercepts.
...
Argumentstopassalongwith
tickers
to
load_gains
.
benchmark.ticker
Characterstringspecifyingtickersymbolforbenchmarkindexforcalculating
beta.Ifthefundin
tickers
isusedasthebenchmark.
reference.tickers
Charactervectoroftickersymbolstoincludeongraphasdatapointsforcom-
parativepurposes.
tickers.gains
Numericmatrixofgains,whereeachcolumnhasgainsforaparticularfund.
benchmark.gains
Numericvectorofgainsforthebenchmarkindexforcalculatingbeta.Ifun-
thefundin
tickers.gains
isusedasthebenchmark.
reference.gains
Numericvectorormatrixofgainsforfundstoincludeongraphasdatapoints
forcomparativepurposes.
target.beta
Numericvalue.
tol
Numericvaluespecifyinghowfartheeffectiveportfoliobetahastodeviatefrom
target.beta
totriggerarebalancingtrade.
window.units
Numericvaluespecifyingthewidthofthetrailingmovingwindowusedtoesti-
mateeachfund'sbeta.
failure.method
Characterstringorvectorspecifyingmethod(s)tousewhenfundbetasaresuch
thatthetargetportfoliobetacannotbeachieved.Choicesare
"cash"
,
"fund1"
,
"fund2"
,
"fund1.maxall"
,
"fund2.maxall"
,
"inverse1"
,
"inverse2"
,and
"closer"
.SeeDetails.
maxall.tol
Numericvaluespecifyingtolerancetousewhenimplementingthe
"fund1.maxall"
or
"fund2.maxall"
failuremethod.Toillustrate,if
target.beta=0
,fund1
hasacurrentbetaof1,fund2hasacurrentbetaof0.25,
failure.method="fund2.maxall"
,
and
maxall.tol=0.1
,atradewillbetriggeredthatresultsin40%fund2and
60%cash.Theportfoliobetais
0.4*0.25=0.1
.Thereasonyoumightwant
maxall.tol
tobelessthan
tol
istoavoidfrequentlytriggeringanothertrade
ontheverynextday,asfund2'sbetachangesalittleandmovestheportfolio
betaoutsideof
[target.beta-tol,target.beta+tol]
.
initial
Numericvaluespecifyingwhatvaluetoscaleinitialpricesto.
*****page brek******32
targetbeta_twofunds
Details
Thegeneralimplementationisasfollows.Betaforeachofthetwofundsisestimatedbasedonthe

window.units
gains.Initialallocationsareselectedtoachieveportfoliobetaof
target.beta
.
Ifthatisnotpossible-forexample,if
target.beta=0
andbothfundshavepositivebeta-then
theactiontakendependsonwhatmethodisselectedthroughthe
failure.method
input(details
below).
Assumingthetargetbetaisattainable,thefunctionmovesover1day,andapplieseachfund'sgains
forthatday.Itthenre-calculateseachfund'sbetabasedonthe
window.units
-widthinterval,and
determinestheeffectiveportfoliobetabasedonfundallocationsandbetas.Iftheeffectivebetais
outsideof
[target.beta-tol,target.beta+tol]
,arebalancingtradeistriggered.As
before,ifthetargetbetacannotbeachieved,certainactionsaretakendependingontheselected
method.
Whenoutsideofatradebecausethetargetbetacouldnotbeachieved,thefunctionattemptsto
rebalanceeachtimeitshiftsovertoanewday,regardlessoftheeffectiveportfoliobeta.
When
failure.method="cash"
,theentireportfoliobalanceisallocatedtocashwhenthetarget
betacannotbeachieved.
When
failure.method="fund1"
(or
"fund2"
),theentireportfoliobalanceisallocatedtothe
(orsecond)fundwhenthetargetbetacannotbeachieved.
When
failure.method="fund1.maxall"
(or
"fund2.maxall"
),whenthetargetbetacannotbe
achieved,fund1(orfund2)iscombinedwithcash,withthefund1(fund2)allocationashighas
possiblewhilestayingwithin
maxall.tol
of
target.beta
.
When
failure.method="inverse1"
(or
"inverse2"
),aninverseversionofthe(orsecond)
fundisusedwhenthetargetbetacannotbeachieved.Inmanycaseswherethetargetbetacannot
beachievedwiththetwofunds,itcanbeachievedwithaninverseversionofoneandtheother.If
thetargetbetastillcannotbeachieved,theentireportfoliobalanceisallocatedtocash.
When
failure.method="closer"
,theentireportfoliobalanceisallocatedtowhicheverfund
hasabetacloserto
target.beta
.
Value
Foreachmethod,a4-elementlistcontaining:
1.
Numericmatrixnamed
fund.balances
givingfundbalancesovertime.
2.
Numericmatrixnamed
fund.betas
givingfundbetasovertime.
3.
Numericvectornamed
effective.betas
givingeffectiveportfoliobetaovertime.
4.
Numericvaluenamed
trades
givingthetotalnumberoftradesexecuted.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
*****page brek******threefunds_graph
33
Examples
##Notrun:
#Backtestzero-betaUPRO/VBLTXstrategy
beta0<-targetbeta_twofunds(tickers=c("UPRO","VBLTX"),target.beta=0)
plot(beta0$fund.balances[,"Portfolio"])
##End(Notrun)
threefunds_graph
GraphOnePerformanceMetricvs.AnotherforThree-FundPortfolio
asAllocationVaries
Description
Usefulforvisualizingperformanceofthree-fundportfolios,typicallybyplottingameasureof
growthvs.ameasureofvolatility.Onlyworksforonethree-fundsetatatime.
Usage
threefunds_graph(tickers=NULL,intercepts=NULL,slopes=NULL,...,
benchmark.tickers=NULL,reference.tickers=NULL,
tickers.gains=NULL,benchmark.gains=NULL,reference.gains=NULL,
step.data=0.0025,step.points=0.1,step.curves=0.2,
x.metric="sd",y.metric="mean",tickerlabel.offsets=NULL,
reflabel.offsets=NULL,add.plot=FALSE,colors=NULL,lty=NULL,
plot.list=NULL,points.list=NULL,text.list=NULL,
pdf.list=NULL,bmp.list=NULL,jpeg.list=NULL,png.list=NULL,
tiff.list=NULL)
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
intercepts
Numericvectorofvaluestoaddtodailygainsforeachticker.
slopes
Numericvectorofvaluestomultiplydailygainsforeachtickerby.Slopesare
multipliedpriortoaddingintercepts.
...
Argumentstopassalongwith
tickers
to
load_gains
.
benchmark.tickers
Charactervectoroflength1or2indicatingtickersymbolsforbenchmarkin-
dexes.Onlyusedif
x.metric
and/or
y.metric
requirebenchmarkindexesto
calculate.Forexample,toplotcorrelationwithSPYonthex-axisandcorrela-
tionwithTLTonthey-axis,set
x.metric="pearson"
,
y.metric="pearson2"
(i.e.Pearsoncorrelationwith2ndbenchmark),and
benchmark.tickers=c("SPY","TLT")
.
reference.tickers
Charactervectoroftickersymbolstoincludeongraphasdatapointsforcom-
parativepurposes.
*****page brek******34
threefunds_graph
tickers.gains
Numericmatrixofgains,whereeachcolumnhasgainsforaparticularfund.
benchmark.gains
Numericvectorormatrixofgainsfor1or2benchmarkindexes.Onlyusedif
x.metric
and/or
y.metric
requirebenchmarkindexestocalculate.Forexam-
ple,toplotcorrelationwithSPYonthex-axisandcorrelationwithTLTonthe
y-axis,set
x.metric="pearson"
and
y.metric="pearson2"
,andinput
benchmark.gains
asa2-columnmatrixofgainsforSPYandTLT.
reference.gains
Numericvectorormatrixofgainsforfundstoincludeongraphasdatapoints
forcomparativepurposes.
step.data
Numericvaluespecifyingallocationincrementsforplottingcurves.
step.points
Numericvaluespecifyingallocationincrementsforaddingdatapointsontopof
curves.Setto
NULL
tosuppressdatapoints.
step.curves
Numericvaluespecifyingallocationincrementsforfundineachset.
x.metric
Characterstringspecifyingx-axisperformancemetric.Choicesare:
"mean"
or
"sd"
formeanorstandarddeviationofgains
"growth"
or
"cagr"
fortotalorannualizedgrowth
"mdd"
formaximumdrawdown
"sharpe"
or
"sortino"
forSharpeorSortinoratio
"alpha"
,
"beta"
,or
"r.squared"
forthosemetricsfromalinearregres-
siononbenchmarkfund
"pearson"
or
"spearman"
forPearsonorSpearmancorrelationwithbenchmark
fund
"alpha2"
,
"beta2"
,
"r.squared2"
,
"pearson2"
,or
"spearman2"
forsameas
previouslydescribed,butusingthesecondbenchmarkindex
"auto.pearson"
or
"auto.spearman"
forPearsonorSpearmanautocorrela-
tion,asthecorrelationbetweensubsequentgains
"allocation"
forallocationtofundineachpair.
y.metric
Sameas
x.metric
,butforthey-axis
tickerlabel.offsets
Eitheranumericvectoroflength2givingthex-andy-axisoffsetsforallticker
labels,ora2-columnmatrixwhereeachrowgivesthex-andy-axisoffsetsfor
aticker.
reflabel.offsets
Eitheranumericvectoroflength2givingthex-andy-axisoffsetsforallrefer-
encetickerlabels,ora2-columnmatrixwhereeachrowgivesthex-andy-axis
offsetsforareferenceticker.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
colors
Charactervectorofcolorsforeachcurve.
lty
Numericvectorspecifyinglinetypesforeachcurve.
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
*****page brek******ticker_dates
35
text.list
Listofargumentstopassto
text
.
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,alistcontaining:
1.
Listnamed
portfolio.xy
whereeachelementisatwo-columnmatrixofx-andy-axisvalues
foracurve.
2.
Numericvectornamed
means
withmeangainsforeachfund.
3.
Numericmatrixnamed
corr.matrix
withacorrelationmatrixforgainsforeachfund.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#Plotmeanvs.SDforUPRO/VBLTX/VWEHXportfolio,andcomparetoVFINXand
#BRK-B
fig<-threefunds_graph(tickers=c("VWEHX","VBLTX","UPRO"),
reference.tickers=c("VFINX","BRK-B"))
##End(Notrun)
ticker_dates
GetYahoo!FinanceStart/EndDatesforTickers
Description
Typicallyusefulfordeterminingatimeperiodoverwhichtocompareseveralfunds.
Usage
ticker_dates(tickers,from="1950-01-01",to=Sys.Date())
*****page brek******36
twofunds_graph
Arguments
tickers
CharactervectorwithtickersymbolsthatYahoo!Financerecognizes.
from
Dateorcharacterstring(e.g.
"2015-01-15"
.
to
Dateorcharacterstring(e.g.
"2016-01-30"
).
Value
Dataframewithtickersymbol,startdate,enddate,andnumberoftradingdaysforeachticker.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#SeewhatdatesareavailableforAppleandAmazon
ticker_dates(c("AAPL","AMZN"))
##End(Notrun)
twofunds_graph
GraphOnePerformanceMetricvs.AnotherforTwo-FundPortfolios
asAllocationVaries
Description
Usefulforvisualizingperformanceoftwo-fundportfolios,typicallybyplottingameasureofgrowth
vs.ameasureofvolatility.Firsttwoinvestmentsareusedasthetwo-fundpair,nexttwoasthe
secondtwo-fundpair,andsoon.
Usage
twofunds_graph(tickers=NULL,intercepts=NULL,slopes=NULL,...,
benchmark.tickers=NULL,reference.tickers=NULL,
tickers.gains=NULL,benchmark.gains=NULL,reference.gains=NULL,
step.data=0.0025,step.points=0.1,x.metric="sd",
y.metric="mean",tickerlabel.offsets=NULL,reflabel.offsets=NULL,
add.plot=FALSE,colors=NULL,lty=NULL,plot.list=NULL,
points.list=NULL,text.list=NULL,pdf.list=NULL,
bmp.list=NULL,jpeg.list=NULL,png.list=NULL,tiff.list=NULL)
*****page brek******twofunds_graph
37
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
intercepts
Numericvectorofvaluestoaddtodailygainsforeachticker.
slopes
Numericvectorofvaluestomultiplydailygainsforeachtickerby.Slopesare
multipliedpriortoaddingintercepts.
...
Argumentstopassalongwith
tickers
to
load_gains
.
benchmark.tickers
Charactervectoroflength1or2indicatingtickersymbolsforbenchmarkin-
dexes.Onlyusedif
x.metric
and/or
y.metric
requirebenchmarkindexesto
calculate.Forexample,toplotcorrelationwithSPYonthex-axisandcorrela-
tionwithTLTonthey-axis,set
x.metric="pearson"
,
y.metric="pearson2"
(i.e.Pearsoncorrelationwith2ndbenchmark),and
benchmark.tickers=c("SPY","TLT")
.
reference.tickers
Charactervectoroftickersymbolstoincludeongraphasdatapointsforcom-
parativepurposes.
tickers.gains
Numericmatrixofgains,whereeachcolumnhasgainsforaparticularfund.
benchmark.gains
Numericvectorormatrixofgainsfor1or2benchmarkindexes.Onlyusedif
x.metric
and/or
y.metric
requirebenchmarkindexestocalculate.Forexam-
ple,toplotcorrelationwithSPYonthex-axisandcorrelationwithTLTonthe
y-axis,set
x.metric="pearson"
and
y.metric="pearson2"
,andinput
benchmark.gains
asa2-columnmatrixofgainsforSPYandTLT.
reference.gains
Numericvectorormatrixofgainsforfundstoincludeongraphasdatapoints
forcomparativepurposes.
step.data
Numericvaluespecifyingallocationincrementsforplottingcurves.
step.points
Numericvaluespecifyingallocationincrementsforaddingdatapointsontopof
curves.Setto
NULL
tosuppressdatapoints.
x.metric
Characterstringspecifyingx-axisperformancemetric.Choicesare:
"mean"
or
"sd"
formeanorstandarddeviationofgains
"growth"
or
"cagr"
fortotalorannualizedgrowth
"mdd"
formaximumdrawdown
"sharpe"
or
"sortino"
forSharpeorSortinoratio
"alpha"
,
"beta"
,or
"r.squared"
forthosemetricsfromalinearregres-
siononbenchmarkfund
"pearson"
or
"spearman"
forPearsonorSpearmancorrelationwithbenchmark
fund
"alpha2"
,
"beta2"
,
"r.squared2"
,
"pearson2"
,or
"spearman2"
forsameas
previouslydescribed,butusingthesecondbenchmarkindex
"auto.pearson"
or
"auto.spearman"
forPearsonorSpearmanautocorrela-
tion,asthecorrelationbetweensubsequentgains
"allocation"
forallocationtofundineachpair.
*****page brek******38
twofunds_graph
y.metric
Sameas
x.metric
,butforthey-axis
tickerlabel.offsets
Eitheranumericvectoroflength2givingthex-andy-axisoffsetsforallticker
labels,ora2-columnmatrixwhereeachrowgivesthex-andy-axisoffsetsfor
aticker.
reflabel.offsets
Eitheranumericvectoroflength2givingthex-andy-axisoffsetsforallrefer-
encetickerlabels,ora2-columnmatrixwhereeachrowgivesthex-andy-axis
offsetsforareferenceticker.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
colors
Charactervectorofcolorsforeachcurve.
lty
Numericvectorspecifyinglinetypesforeachcurve.
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
text.list
Listofargumentstopassto
text
.
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,alistcontaining:
1.
Listnamed
portfolio.xy
whereeachelementisatwo-columnmatrixofx-andy-axisvalues
forafundpair.
2.
Numericvectornamed
means
withmeangainsforeachfund.
3.
Numericmatrixnamed
corr.matrix
withacorrelationmatrixforgainsforeachfund.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#Plotmeanvs.SDforUPRO/VBLTXportfolio,andcomparetoVFINXandBRK-B
fig1<-twofunds_graph(tickers=c("UPRO","VBLTX"),
reference.tickers=c("VFINX","BRK-B"))
#Samefunds,butannualizedgrowthvs.maximumdrawdown
fig2<-twofunds_graph(tickers=c("UPRO","VBLTX"),
reference.tickers=c("VFINX","BRK-B"),
*****page brek******twometrics_graph
39
x.metric="mdd",y.metric="cagr")
##End(Notrun)
twometrics_graph
GraphOnePerformanceMetricvs.AnotherforVariousInvestments
Description
Usefulforvisualizingtheperformanceofagroupofinvestments.Theinvestmentisusedas
thebenchmarkif
x.metric
or
y.metric
requireonebenchmark,andthetwoinvestmentsare
usedasbenchmarksif
x.metric
and
y.metric
requiredifferentbenchmarks.
Usage
twometrics_graph(tickers=NULL,...,gains=NULL,prices=NULL,
x.metric="mdd",y.metric="cagr",tickerlabel.offsets=NULL,
add.plot=FALSE,colors=NULL,plot.list=NULL,points.list=NULL,
text.list=NULL,pdf.list=NULL,bmp.list=NULL,jpeg.list=NULL,
png.list=NULL,tiff.list=NULL)
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
...
Argumentstopassalongwith
tickers
to
load_gains
.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
x.metric
Characterstringspecifyingx-axisperformancemetric.Choicesare:
"mean"
or
"sd"
formeanorstandarddeviationofgains.
"growth"
or
"cagr"
fortotalorannualizedgrowth.
"mdd"
formaximumdrawdown.
"sharpe"
or
"sortino"
forSharpeorSortinoratio.
"alpha"
,
"beta"
,or
"r.squared"
forthosemetricsfromalinearregres-
siononbenchmarkfund.
"pearson"
or
"spearman"
forPearsonorSpearmancorrelationwithbenchmark
fund.
"alpha2"
,
"beta2"
,
"r.squared2"
,
"pearson2"
,or
"spearman2"
forsameas
previouslydescribed,butusingthesecondbenchmarkindex.
"auto.pearson"
or
"auto.spearman"
forPearsonorSpearmanautocorrela-
tion,asthecorrelationbetweensubsequentgains.
y.metric
Sameas
x.metric
,butforthey-axis.
*****page brek******40
vanguard_balanced_funds
tickerlabel.offsets
Eitheranumericvectoroflength2givingthex-andy-axisoffsetsforallticker
labels,ora2-columnmatrixwhereeachrowgivesthex-andy-axisoffsetsfor
aticker.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
colors
Charactervectorofcolorsforeachcurve.
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
text.list
Listofargumentstopassto
text
.
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,adataframecontainingtheperformancemetricsforeachinvestment.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#Plotannualizedgrowthvs.maximumdrawdownforVFINX,SSO,andUPRO
fig<-twometrics_graph(tickers=c("VFINX","SSO","UPRO"))
##End(Notrun)
vanguard_balanced_funds
VanguardBalancedMutualFundsandInceptionDates
Description
VanguardBalancedMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
*****page brek******vanguard_bond_etfs
41
vanguard_bond_etfs
VanguardBondETFsandInceptionDates
Description
VanguardBondETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_bond_funds
VanguardBondMutualFunds
Description
VanguardBondMutualFunds
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_etfs
VanguardETFsandInceptionDates
Description
VanguardETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_funds
VanguardMutualFundsandInceptionDates
Description
VanguardMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
*****page brek******42
vanguard_international_etfs
vanguard_igrade_etfs
VanguardInvestment-gradeBondETFsandInceptionDates
Description
VanguardInvestment-gradeBondETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_igrade_funds
VanguardInvestment-gradeBondMutualFundsandInceptionDates
Description
VanguardInvestment-gradeBondMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_international_etfs
VanguardInternationalETFsandInceptionDates
Description
VanguardInternationalETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
*****page brek******vanguard_international_funds
43
vanguard_international_funds
VanguardInternationalMutualFundsandInceptionDates
Description
VanguardInternationalMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_largecap_etfs
VanguardLarge-capStockETFsandInceptionDates
Description
VanguardLarge-capStockETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_largecap_funds
VanguardLarge-capStockMutualFundsandInceptionDates
Description
VanguardLarge-capStockMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
*****page brek******44
vanguard_sector_funds
vanguard_midcap_etfs
VanguardMid-capStockETFsandInceptionDates
Description
VanguardMid-capStockETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_midcap_funds
VanguardMid-capStockMutualFundsandInceptionDates
Description
VanguardMid-capStockMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_sector_etfs
VanguardSector&SpecialtyETFsandInceptionDates
Description
VanguardSector&SpecialtyETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_sector_funds
VanguardSectorMutualFundsandInceptionDates
Description
VanguardSectorMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
*****page brek******vanguard_smallcap_etfs
45
vanguard_smallcap_etfs
VanguardSmall-capStockETFsandInceptionDates
Description
VanguardSmall-capStockETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_smallcap_funds
VanguardSmall-capStockMutualFundsandInceptionDates
Description
VanguardSmall-capStockMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_stock_etfs
VanguardStockETFsandInceptionDates
Description
VanguardStockETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
*****page brek******46
vanguard_targetrisk_funds
vanguard_stock_funds
VanguardStockMutualFundsandInceptionDates
Description
VanguardStockMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_targetdate_funds
VanguardTargetDateMutualFunds
Description
VanguardTargetDateMutualFunds
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_targetrisk_funds
VanguardTargetRiskMutualFundsandInceptionDates
Description
VanguardTargetRiskMutualFundsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
*****page brek******vanguard_taxexempt_bond_funds
47
vanguard_taxexempt_bond_funds
VanguardTax-exemptBondMutualFundsandInceptionDates
Description
VanguardTax-exemptBondMutualFundsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_traditional_funds
VanguardTraditionalMutualFundsandInceptionDates
Description
VanguardTraditionalMutualFundsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_treasury_etfs
VanguardTreasury/AgencyBondETFsandInceptionDates
Description
VanguardTreasury/AgencyBondETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
*****page brek******48
vanguard_treasury_funds
vanguard_treasury_funds
VanguardTreasury/AgencyBondMutualFundsandInceptionDates
Description
VanguardTreasury/AgencyBondMutualFundsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
*****page brek******Index
axis
,
19
beta_trailing50
,
3
bmp
,
10
,
13
,
20
,
21
,
35
,
38
,
40
contango_hedged
,
4
contango_simple
,
5
convert_gain
,
7
daily_yearly
,
8
diff
,
8
diffs
,
8
gains_graph
,
9
gains_prices
,
10
gains_rate
,
11
grid
,
13
growth_graph
,
12
highyield_etfs
,
13
jpeg
,
10
,
13
,
20
,
21
,
35
,
38
,
40
largest_etfs
,
14
legend
,
10
,
13
,
21
lm
,
10
load_gains
,
3
,
5
,
6
,
9
,
12
,
14
,
18
,
19
,
21
,
30
,
31
,
33
,
37
,
39
load_prices
,
15
mdd
,
17
metrics
,
18
onemetric_graph
,
19
onemetric_overtime_graph
,
20
pchanges
,
22
pdf
,
10
,
13
,
20
,
21
,
35
,
38
,
40
pdiffs
,
23
plot
,
10
,
13
,
19
,
21
,
34
,
38
,
40
png
,
10
,
13
,
20
,
21
,
35
,
38
,
40
points
,
10
,
13
,
19
,
21
,
34
,
38
,
40
prices_gains
,
23
prices_rate
,
24
ratios
,
25
rrr
,
26
sector_spdr_etfs
,
27
sharpe
,
27
sortino
,
28
stocks
,
28
stocks-package
(
stocks
)
,
28
targetall
,
29
targetbeta_twofunds
,
30
text
,
35
,
38
,
40
threefunds_graph
,
33
ticker_dates
,
35
tiff
,
10
,
13
,
20
,
21
,
35
,
38
,
40
twofunds_graph
,
36
twometrics_graph
,
39
vanguard_balanced_funds
,
40
vanguard_bond_etfs
,
41
vanguard_bond_funds
,
41
vanguard_etfs
,
41
vanguard_funds
,
41
vanguard_igrade_etfs
,
42
vanguard_igrade_funds
,
42
vanguard_international_etfs
,
42
vanguard_international_funds
,
43
vanguard_largecap_etfs
,
43
vanguard_largecap_funds
,
43
vanguard_midcap_etfs
,
44
vanguard_midcap_funds
,
44
vanguard_sector_etfs
,
44
vanguard_sector_funds
,
44
vanguard_smallcap_etfs
,
45
vanguard_smallcap_funds
,
45
vanguard_stock_etfs
,
45
49
*****page brek******50
INDEX
vanguard_stock_funds
,
46
vanguard_targetdate_funds
,
46
vanguard_targetrisk_funds
,
46
vanguard_taxexempt_bond_funds
,
47
vanguard_traditional_funds
,
47
vanguard_treasury_etfs
,
47
vanguard_treasury_funds
,
48
*****page brek******Package`stocks'
August31,2018
Type
Package
Title
StockMarketAnalysis
Version
1.1.4
License
GPL-3
Date
2018-08-30
Author
DaneR.VanDomelen
Maintainer
DaneR.VanDomelen
<vandomed@gmail.com>
Description
Functionsforanalyzingstocksorotherinvestments.Mainfeaturesareloadingandalign-
inghistoricaldatafortickersymbols,calculatingperformancemetricsforindivid-
ualfundsorportfolios(e.g.annualizedgrowth,maximumdrawdown,Sharpe/Sortinora-
tio),andcreatinggraphs.C++codeisusedtoimproveprocessingspeedwherepossible.
Depends
rbenchmark,quantmod
Imports
dvmisc,graphics,grDevices,Hmisc,lubridate,methods,
RColorBrewer,Rcpp(>=0.12.15),stats,TTR,zoo
Suggests
knitr,rmarkdown,pander,printr
LinkingTo
Rcpp
RoxygenNote
6.0.1
NeedsCompilation
yes
Repository
CRAN
Date/Publication
2018-08-3104:30:03UTC
R
topicsdocumented:
beta_trailing50.......................................
3
contango_hedged......................................
4
contango_simple......................................
5
convert_gain.........................................
7
daily_yearly.........................................
8
diffs.............................................
8
gains_graph.........................................
9
gains_prices.........................................
10
1
*****page break******2
R
topicsdocumented:
gains_rate..........................................
11
growth_graph........................................
12
highyield_etfs........................................
13
largest_etfs.........................................
14
load_gains..........................................
14
load_prices.........................................
15
mdd.............................................
17
metrics............................................
18
onemetric_graph......................................
19
onemetric_overtime_graph.................................
20
pchanges..........................................
22
pdiffs............................................
23
prices_gains.........................................
23
prices_rate..........................................
24
ratios............................................
25
rrr..............................................
26
sector_spdr_etfs.......................................
27
sharpe............................................
27
sortino............................................
28
stocks............................................
28
targetall...........................................
29
targetbeta_twofunds.....................................
30
threefunds_graph......................................
33
ticker_dates.........................................
35
twofunds_graph.......................................
36
twometrics_graph......................................
39
vanguard_balanced_funds.................................
40
vanguard_bond_etfs.....................................
41
vanguard_bond_funds....................................
41
vanguard_etfs........................................
41
vanguard_funds.......................................
41
vanguard_igrade_etfs....................................
42
vanguard_igrade_funds...................................
42
vanguard_international_etfs.................................
42
vanguard_international_funds...............................
43
vanguard_largecap_etfs...................................
43
vanguard_largecap_funds..................................
43
vanguard_midcap_etfs...................................
44
vanguard_midcap_funds..................................
44
vanguard_sector_etfs....................................
44
vanguard_sector_funds...................................
44
vanguard_smallcap_etfs...................................
45
vanguard_smallcap_funds.................................
45
vanguard_stock_etfs....................................
45
vanguard_stock_funds...................................
46
vanguard_targetdate_funds.................................
46
vanguard_targetrisk_funds.................................
46
vanguard_taxexempt_bond_funds.............................
47
*****page break******beta_trailing50
3
vanguard_traditional_funds.................................
47
vanguard_treasury_etfs...................................
47
vanguard_treasury_funds..................................
48
Index
49
beta_trailing50
BetaforLast50DailyGains
Description
Calculatesbetaforatickersymbolbasedontheprevious50dailygains.
Usage
beta_trailing50(ticker,bench="SPY",...)
Arguments
ticker
CharacterstringwithtickersymbolsthatYahoo!Financerecognizes.
bench
Characterstringwithtickersymbolforbenchmark.
...
Argumentstopassto
load_gains
.
Value
Numericvalue.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#CalculateTLT
'
sbetabasedontheprevious50dailygains
beta_trailing50("TLT")
##End(Notrun)
*****page break******4
contango_hedged
contango_hedged
BacktestaHedgedContango-BasedVolatilityTradingStrategy
Description
Implementsthefollowingstrategy:Eachday,holdXIV/SPXU(weightedforzerobeta)ifcontango
>
xiv.spxu.cutpoint
,holdVXX/UPRO(weightedforzerobeta)ifcontango<
vxx.upro.cutpoint
,
andholdcashotherwise.PerhapsnotveryusefulsinceXIVclosedonFeb.20,2018.
Usage
contango_hedged(contango,xiv.spxu.gains=NULL,vxx.upro.gains=NULL,
xiv.spxu.cutpoint=6.36,vxx.upro.cutpoint=5.45,
xiv.allocation=0.46,vxx.allocation=0.46,xiv.beta=NULL,
vxx.beta=NULL,initial=10000)
Arguments
contango
Numericvectorofcontangovaluesattheendofeachtradingday.
xiv.spxu.gains
2-columnnumericmatrixwithgainsforXIVandSPXU.Shouldhavethesame
numberofrowsas
contango
andbedate-shiftedonevaluetotheright.For
example,therowshouldhavetheXIVandSPXUgainsforthedayAFTER
thecontangovalue.
vxx.upro.gains
2-columnnumericmatrixwithgainsforVXXandUPRO.Shouldhavethesame
numberofrowsas
contango
andbedate-shiftedonevaluetotheright.For
example,therowshouldhavetheVXXandUPROgainsforthedayAFTER
thecontangovalue.
xiv.spxu.cutpoint
NumericvaluegivingthecontangocutpointforXIV/SPXUposition.Forexam-
ple,if
xiv.spxu.cutpoint=5
,XIV/SPXUwillbeheldwhenevercontango
isgreaterthan5%.
vxx.upro.cutpoint
NumericvaluegivingthecontangocutpointforVXX/UPROposition.Forex-
ample,if
vxx.upro.cutpoint=-5
,VXX/UPROwillbeheldwhenevercon-
tangoislessthan-5%.
xiv.allocation
NumericvaluespecifyingXIVallocationforXIV/SPXUposition.Forexample,
ifsetto0.46,46%isallocatedtoXIVand54%toSPXUwhencontango>
xiv.spxu.cutpoint
.
vxx.allocation
NumericvaluespecifyingVXXallocationforVXX/UPROposition.Forexam-
ple,ifsetto0.46,46%isallocatedtoVXXand54%toUPROwhencontango
<
vxx.upro.cutpoint
.
xiv.beta
NumericvaluespecifyingXIV'sbeta.Ifspecithefunctionoutwhat
xiv.allocation
needstobeforzero-betaXIV/SPXUpositions.Forexample,
ifsetto3.5,then46.2%XIV/53.8%SPXUachieveszerobeta.
*****page break******contango_simple
5
vxx.beta
NumericvalueindicatingVXX'sbeta.Ifthefunctionoutwhat
vxx.allocation
needstobeforzero-betaVXX/UPROpositions.Forexample,
ifsetto-3.5,then46.2%VXX/53.8%UPROachieveszerobeta.
initial
Numericvaluegivingtheinitialvalueoftheportfolio.
Details
YoucanhistoricalcontangovaluesfromTheIntelligentInvestorBlog.Youcanclickthe
linkat
http://investing.kuchita.com/2012/06/28/xiv-data-and-pricing-model-since-vix-futures-available-2004/
todownloadazipcontaininganExcelspreadsheet.Then,youwillneedtocalculatewhatever
versionof"contango"youprefer.Itypicallycontangoaswhatpercenthigherthesecond-
monthVIXfuturesareacomparedtothefutures,i.e.dividingthe"2ndmth"columnby
the"1stmth"column,subtracting1,andthenmultiplyingby100.
ToloaddailygainsforXIV,SPXU,VXX,andUPRO,youcanuse
load_gains
,whichusesthe
quantmod
packagetoloaddatafromYahoo!Finance.Youwillhavetospecifythe
from
and
to
inputstomatchthedaterangeforyourcontangovalues.
Value
Listcontaining:
1.
Charactervectornamed
holdings
indicatingwhatfundwasheldeachday(XIV/SPXU,
VXX/UPRO,orcash).
2.
Numericvectornamed
port.gains
givingtheportfoliogainforeachday,whichwillbe0for
daysthatcashwasheldandtheweightedXIV/SPXUorVXX/UPROgainfordaysthatone
ofthosepositionswasheld.
3.
Numericvectornamed
port.balances
givingtheportfoliobalanceeachday.
4.
Numericvaluenamed
trades
givingthetotalnumberoftradesexecuted.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
contango_simple
BacktestaSimpleContango-BasedVolatilityTradingStrategy
Description
Simplestrategy:Eachday,holdXIVifcontango>
xiv.cutpoint
,holdVXXifcontango<
vxx.cutpoint
,andholdcashotherwise.PerhapsnotveryusefulsinceXIVclosedonFeb.20,
2018.
Usage
contango_simple(contango,xiv.gains=NULL,vxx.gains=NULL,
xiv.cutpoint=0,vxx.cutpoint=-Inf,initial=10000)
*****page break******6
contango_simple
Arguments
contango
Numericvectorofcontangovaluesattheendofeachtradingday.
xiv.gains
NumericvectorofgainsforXIV.Shouldbesamelengthas
contango
anddate-
shiftedonevaluetotheright.Forexample,thevalueof
xiv.gains
should
betheXIVgainforthedayAFTERthecontangovalue.
vxx.gains
NumericvectorofgainsforVXX.Shouldbesamelengthas
contango
anddate-
shiftedonevaluetotheright.Forexample,thevalueof
vxx.gains
should
betheVXXgainforthedayAFTERthecontangovalue.
xiv.cutpoint
NumericvaluegivingthecontangocutpointforXIV,inpercent.
vxx.cutpoint
NumericvaluegivingthecontangocutpointforVXX,inpercent.
initial
Numericvaluegivingtheinitialvalueoftheportfolio.
Details
YoucanhistoricalcontangovaluesfromTheIntelligentInvestorBlog.Youcanclickthe
linkat
http://investing.kuchita.com/2012/06/28/xiv-data-and-pricing-model-since-vix-futures-available-2004/
todownloadazipcontaininganExcelspreadsheet.Then,youwillneedtocalculatewhatever
versionof"contango"youprefer.Itypicallycontangoaswhatpercenthigherthesecond-
monthVIXfuturesareacomparedtothefutures,i.e.dividingthe"2ndmth"columnby
the"1stmth"column,subtracting1,andthenmultiplyingby100.
Ithinkthemostcommonapproachforcontango-basedvolatilitystrategiesisholdingXIV(inverse
volatility)whencontangoisabovesomevalue(e.g.0%,5%,or10%),andholdingcashotherwise.
Youcandothatwiththisfunctionbyleaving
vxx.cutpoint
as
-Inf
.However,youmayalsowant
toholdVXX(volatility)whencontangoisbelowsomevalue(e.g.0%,-5%,-10%),alsoknownas
"backwardation".YoucanimplementanXIV-only,VXX-only,orXIVandVXXstrategywiththis
function.
ToloaddailygainsforXIVand/orVXX,youcanuse
load_gains
,whichusesthe
quantmod
package[1]toloaddatafromYahoo!Finance.Youwillhavetospecifythe
from
and
to
inputsto
matchthedaterangeforyourcontangovalues.
Value
Listcontaining:
1.
Charactervectornamed
holdings
indicatingwhatfundwasheldeachday(XIV,VXX,or
cash).
2.
Numericvectornamed
port.gains
givingtheportfoliogainforeachday,whichwillbe0for
daysthatcashwasheldandtheXIVorVXXgainfordaysthatXIVorVXXwasheld.
3.
Numericvectornamed
port.balances
givingtheportfoliobalanceeachday.
4.
Numericvaluenamed
trades
givingthetotalnumberoftradesexecuted.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
*****page break******convert_gain
7
convert_gain
ConvertGainfromOneTimeIntervaltoAnother
Description
Forexample,youcanusethisfunctiontooutthatan8tradingdaysis31.9
Usage
convert_gain(gain,units.in=1,units.out=1)
Arguments
gain
Numericvaluespecifyingagain,e.g.0.005for0.5avectorofgains.
units.in
Numericvaluegvingthetimeperiodoverwhichthegainwasachieved.
units.out
Numericvaluegivingthetimeperiodyouwanttoconvertto.
Value
Numericvalueorvector.
Examples
#Calculateannualizedgainforan8%gainovera70-dayperiod
convert_gain(gain=0.08,units.in=70,units.out=252)
#Calculatetheannualgrowthrateofafundthatgains0.02%perday
convert_gain(gain=0.0002,units.in=1,units.out=252)
#Calculatetheannualgrowthrateofafundthatgains1%perweek
convert_gain(gain=0.01,units.in=1,units.out=52)
#YouinvestinAAPLandgain0.5%in17businessdays.Expressasa5-year
#growthrate.
convert_gain(gain=0.005,units.in=17,units.out=252*5)
#Yourportfoliohastripledina13-yearperiod.Calculateyouraverage
#annualgain.
convert_gain(gain=2,units.in=13,units.out=1)
*****page break******8
diffs
daily_yearly
ConvertDailyGaintoX-yearGain
Description
Forexample,youcanusethisfunctiontocalculatethataninvestmentthatgains0.1days).
Usage
daily_yearly(gain,years=1)
Arguments
gain
Numericvaluespecifyingagain,e.g.0.005for0.5avectorofgains.
years
Numericvalue.
Value
Numericvalueorvector.
Examples
#Calculateannualgainforaninvestmentthatgains0.1%perday
daily_yearly(gain=0.001)
#Calculate5-yeargainscorrespondingtovariousdailygains
daily_yearly(gain=seq(0,0.001,0.0001),years=5)
diffs
LaggedDifferences(AlternateImplementation)
Description
Calculatesdifferencesbetweensubsequent(orlagged)elementsofavector.Verysimilarto
diff
,
butwritteninC++.
Usage
diffs(x,lag=1L)
Arguments
x
Numericvector.
lag
Numericvalue(e.g.2fordifferencesbetween1stand3rdelement,2ndand4th,
...).
*****page break******gains_graph
9
Value
Numericvector.
Examples
#Generate1millionvaluesfromPoisson(3)distribution
x<-rpois(100000,3)
#Calculatevectorofdifferencesbetweensubsequentvalues
y<-diffs(x)
#CouldgetsameresultfrombaseRfunctiondiff
z<-diff(x)
all.equal(y,z)
#Butdiffsisfaster
benchmark(diffs(x),diff(x),replications=100)
gains_graph
ScatterplotofInvestmentGains
Description
Usefulforvisualizingrelationshipbetweenone(orseveral)investmentsandabenchmark.First
fundin
tickers
,
gains
,or
prices
isusedasthebenchmark.
Usage
gains_graph(tickers=NULL,...,gains=NULL,prices=NULL,
orders=1,add.plot=FALSE,include.legend=TRUE,colors=NULL,
lty=NULL,plot.list=NULL,points.list=NULL,legend.list=NULL,
pdf.list=NULL,bmp.list=NULL,jpeg.list=NULL,png.list=NULL,
tiff.list=NULL)
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
...
Argumentstopassalongwith
tickers
to
load_gains
.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
*****page break******10
gains_prices
orders
Numericvectorspecifyingtheordersoflinearregressionmodelsforeachy-
axisinvestment.Setto
1
forsimplelinearregression,
2
forlinearregression
withandsecond-orderterms,andsoon.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
include.legend
Logicalvalue.
colors
Charactervectorofcolorsforeachcurve.
lty
Numericvectorspecifyinglinetypesforeachcurve.
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
legend.list
Listofargumentstopassto
legend
.
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,alistcontaininglinearregressionmodelsreturnedby
lm
foreach
investmentvs.thebenchmark.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#PlotdailygainsforSSOandUPROvs.VFINX
fig<-gains_graph(c("VFINX","SSO","UPRO"))
##End(Notrun)
gains_prices
ConvertGainstoPrices
Description
Calculatespricesbasedoninitialbalanceandvectorofgains.
*****page break******gains_rate
11
Usage
gains_prices(gains,initial=10000)
Arguments
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
initial
Numericvalue.
Value
Numericvalueif
gains
isavector,numericmatrixif
gains
isamatrix.
Examples
#Simulatedailygainsovera5-yearperiod
set.seed(123)
gains<-rnorm(n=252*5,mean=0.001,sd=0.02)
#Plotbalanceovertimeifinitialbalanceis$10,000
prices<-gains_prices(gains)
plot(prices)
gains_rate
CalculateGrowthRateFromaVectorofGains
Description
Theformulaissimply:
prod(gains+1)-1
.If
units.rate
isthenitconvertsto
x-unitgrowthrate.
Usage
gains_rate(gains,units.rate=NULL)
Arguments
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
units.rate
Numericvaluespecifyingthenumberofunitsforgrowthratecalculation,ifyou
wantsomethingotherthantotalgrowth.Forannualizedgrowthrate,setto252
if
gains
hasdailygains,12if
gains
hasmonthlygains,etc.
Value
Numericvalueif
gains
isavector,numericmatrixif
gains
isamatrix.
*****page break******12
growth_graph
Examples
#Createvectorofdailygainsforahypotheticalstock
daily.gains<-c(-0.02,-0.01,0.01,0.02,0.01)
#Overallgrowthis0.95%
gains_rate(daily.gains)
#Averagedailygrowthis0.19%
gains_rate(daily.gains,1)
#Correspondsto61.0%annualgrowth
gains_rate(daily.gains,252)
growth_graph
GraphInvestmentGrowth
Description
Usefulforcomparingperformanceofinvestmentsovertime.
Usage
growth_graph(tickers=NULL,...,gains=NULL,prices=NULL,
initial="10k",add.plot=FALSE,colors=NULL,lty=NULL,
plot.list=NULL,points.list=NULL,grid.list=NULL,
legend.list=NULL,pdf.list=NULL,bmp.list=NULL,
jpeg.list=NULL,png.list=NULL,tiff.list=NULL)
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
...
Argumentstopassalongwith
tickers
to
load_gains
.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
initial
Numericvaluespecifyingwhatvaluetoscaleinitialpricesto.Canalsobechar-
acterstringendingin"k",e.g.
"10k"
tographgrowthof$10kwithoutallthe
0's.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
colors
Charactervectorofcolorsforeachcurve.
lty
Numericvectorspecifyinglinetypesforeachcurve.
*****page break******highyield_etfs
13
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
grid.list
Listofargumentstopassto
grid
.
legend.list
Listofargumentstopassto
legend
.
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,alistcontaining:
1.
Numericmatrixnamed
prices
withpricesforeachinvestment.
2.
Numericvectornamed
means
withmeanofgainsforeachinvestment.
3.
Numericmatrixnamed
corr.matrix
withcorrelationmatrixforgainsforeachinvestment.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#Plotgrowthof$10kinVFINXandBRK-B
fig<-growth_graph(c("VFINX","BRK-B"))
##End(Notrun)
highyield_etfs
High-YieldETFsfromETFdb.comandInceptionDates
Description
High-YieldETFsfromETFdb.comandInceptionDates
Source
http://etfdb.com/etfdb-category/high-yield-bonds/#etfs&sort_name=assets_under_management&
sort_order=desc&page=2
*****page break******14
load_gains
largest_etfs
Largest100MarketCapETFs(asof3/2/18)andInceptionDates
Description
Largest100MarketCapETFs(asof3/2/18)andInceptionDates
Source
http://etfdb.com/compare/market-cap/
load_gains
DownloadandAlignGainsforaSetofTickers
Description
DownloadsandalignshistoricalinvestmentgainsfortickersfromYahoo!Finance,using
the
quantmod
package.
Usage
load_gains(tickers,intercepts=NULL,slopes=NULL,from="1950-01-01",
to=Sys.Date(),time.scale="daily",preto.days=NULL,
prefrom.days=NULL,earliest=FALSE,latest=FALSE)
Arguments
tickers
CharactervectorwithtickersymbolsthatYahoo!Financerecognizes.
intercepts
Numericvectorofvaluestoaddtodailygainsforeachticker.
slopes
Numericvectorofvaluestomultiplydailygainsforeachtickerby.Slopesare
multipliedpriortoaddingintercepts.
from
Dateorcharacterstring(e.g.
"2015-01-15"
.
to
Dateorcharacterstring(e.g.
"2016-01-30"
).
time.scale
Characterstringcontrollingtimeframeforgains.Choicesare
"daily"
,
"monthly"
,
and
"yearly"
.
preto.days
Numericvalue.Ifspecifunctionreturnsgainsfor
preto.days
tradingdays
priorto
to
.Toillustrate,toloadthemostrecent50dailygains,youwouldleave
to
and
time.scale
asthedefaultsandset
preto.days=50
.
prefrom.days
Numericvalue.Iffunctionreturnsgainsfor
prefrom.days
trading
dayspriorto
from
.Usefulwhenyouwanttotestatradingstrategystartingona
particulardate,butthestrategyrequiresdataleadinguptothatdate(e.g.trailing
beta).
*****page break******load_prices
15
earliest
Logicalvalueforwhethertoretainonlythesubsetoftickerswithdatagoingthe
furthestback.Setto
FALSE
ifyouwantalltickersretainedandgainsovertheir
mutuallifetimes.
latest
Logicalvalueforwhethertoretainonlythesubsetoftickerswithdatagoingthe
furthestforward,e.g.droppingfundsthatwerediscontinuedatsomepoint.
Details
Inaligninghistoricalprices,datesonwhichnotallfundshavedataaresimplydropped.Messages
areprintedindicatingwhichdatesaredroppedforwhichtickers.
Value
Numericmatrix.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#LoadgainsforNetflixandAmazonovertheirmutuallifetimes
gains<-load_gains(c("NFLX","AMZN"))
##End(Notrun)
load_prices
DownloadandAlignHistoricalPricesforaSetofTickers
Description
DownloadsandalignshistoricalpricesfortickersfromYahoo!Finance,usingthe
quant-
mod
package.
Usage
load_prices(tickers,intercepts=NULL,slopes=NULL,
from="1950-01-01",to=Sys.Date(),time.scale="daily",
preto.days=NULL,prefrom.days=NULL,initial=NULL,
earliest=FALSE,latest=FALSE)
*****page break******16
load_prices
Arguments
tickers
CharactervectorwithtickersymbolsthatYahoo!Financerecognizes.
intercepts
Numericvectorofvaluestoaddtodailygainsforeachticker.
slopes
Numericvectorofvaluestomultiplydailygainsforeachtickerby.Slopesare
multipliedpriortoaddingintercepts.
from
Dateorcharacterstring(e.g.
"2015-01-15"
.
to
Dateorcharacterstring(e.g.
"2016-01-30"
).
time.scale
Characterstringcontrollingtimeframeforgains.Choicesare
"daily"
,
"monthly"
,
and
"yearly"
.
preto.days
Numericvalue.Ifspecifunctionreturnsgainsfor
preto.days
tradingdays
priorto
to
.Toillustrate,toloadthemostrecent50dailygains,youwouldleave
to
and
time.scale
asthedefaultsandset
preto.days=50
.
prefrom.days
Numericvalue.Iffunctionreturnsgainsfor
prefrom.days
trading
dayspriorto
from
.Usefulwhenyouwanttotestatradingstrategystartingona
particulardate,butthestrategyrequiresdataleadinguptothatdate(e.g.trailing
beta).
initial
Numericvaluespecifyingwhatvaluetoscaleinitialpricesto.
earliest
Logicalvalueforwhethertoretainonlythesubsetoftickerswithdatagoingthe
furthestback.Setto
FALSE
ifyouwantalltickersretainedandgainsovertheir
mutuallifetimes.
latest
Logicalvalueforwhethertoretainonlythesubsetoftickerswithdatagoingthe
furthestforward,e.g.droppingfundsthatwerediscontinuedatsomepoint.
Details
Inaligninghistoricalprices,datesonwhichnotallfundshavedataaresimplydropped.Messages
areprintedindicatingwhichdatesaredroppedforwhichtickers.
Value
Numericmatrix.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#LoadpricesforNetflixandAmazonovertheirmutuallifetimes
prices<-load_prices(c("NFLX","AMZN"))
##End(Notrun)
*****page break******mdd
17
mdd
MaximumDrawdown
Description
Calculatesmaximumdrawdownfromvectorofclosingprices,highsandlows,orgains.
Usage
mdd(prices=NULL,highs=NULL,lows=NULL,gains=NULL,
indices=FALSE)
Arguments
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
highs
Numericvectorofdailyhighprices.
lows
Numericvectorofdailylowprices.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
indices
Logicalvalueforwhethertoincludeindicesforwhenthemaximumdrawdown
occurred.
Value
Numericvalue,vector,ormatrixdependingon
indices
andwhetherthereis1fundorseveral.
Examples
##Notrun:
#Simulateminute-to-minutestockgainsovera2-yearperiod
set.seed(123)
stock.gains<-rnorm(6.5*60*252*2,0.000005,0.001)
#Converttostockpricesassuminganinitialpriceof$9.50pershare
stock.prices<-gains_prices(gains=stock.gains,initial=9.50)
#Plotminute-to-minutestockprices(200kdatapoint,maybeslow)
plot(stock.prices)
#Maximumdrawdownbasedonstockprices
mdd(prices=stock.prices)
#Sameanswerusinggainsratherthanprices
mdd(gains=stock.gains)
##End(Notrun)
*****page break******18
metrics
metrics
CalculateVariousPerformanceMetrics
Description
Usefulforcomparingmetricsforseveralinvestments.Theinvestmentisusedasthebenchmark
ifrequestedmetricsrequireone.
Usage
metrics(tickers=NULL,...,gains=NULL,prices=NULL,
perf.metrics=c("mean","sd","growth","cagr","mdd","sharpe","sortino",
"alpha","beta","r.squared","pearson","spearman","auto.pearson",
"auto.spearman"))
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
...
Argumentstopassalongwith
tickers
to
load_gains
.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
perf.metrics
Charactervectorspecifyingmetricstocalculate.
Value
Listcontaining:
1.
Numericmatrixnamed
perf.metrics
withperformancemetrics.
2.
Numericmatrixnamed
cor.mat
withcorrelationmatrixforgainsforthevariousinvestments.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#CalculateperformancemetricsforSSOandUPRO,usingSPYasbenchmark
#foralphaandbeta
metrics1<-metrics(tickers=c("SPY","SSO","UPRO"))
##End(Notrun)
*****page break******onemetric_graph
19
onemetric_graph
GraphPerformanceMetricforVariousInvestments
Description
Usefulforvisualizingtheperformanceofagroupofinvestments.Theinvestmentisusedas
thebenchmarkiftherequestedmetricrequiresone.
Usage
onemetric_graph(tickers=NULL,...,gains=NULL,prices=NULL,
y.metric="cagr",add.plot=FALSE,sort.tickers=TRUE,
plot.list=NULL,points.list=NULL,axis.list=NULL,
pdf.list=NULL,bmp.list=NULL,jpeg.list=NULL,png.list=NULL,
tiff.list=NULL)
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
...
Argumentstopassalongwith
tickers
to
load_gains
.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
y.metric
Characterstringspecifyingy-axisperformancemetric.Choicesare:
"mean"
or
"sd"
formeanorstandarddeviationofgains.
"growth"
or
"cagr"
fortotalorannualizedgrowth.
"mdd"
formaximumdrawdown.
"sharpe"
or
"sortino"
forSharpeorSortinoratio.
"alpha"
,
"beta"
,or
"r.squared"
forthosemetricsfromalinearregres-
siononbenchmarkfund.
"pearson"
or
"spearman"
forPearsonorSpearmancorrelationwithbenchmark
fund.
"auto.pearson"
or
"auto.spearman"
forPearsonorSpearmanautocorrela-
tion,asthecorrelationbetweensubsequentgains.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
sort.tickers
Logicalvalueforwhethertosortinvestmentsindecreasingorderoftheperfor-
mancemetric.
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
axis.list
Listofargumentstopassto
axis
.
*****page break******20
onemetric_overtime_graph
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,adataframecontainingtheperformancemetricforeachinvestment.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#CompareannualizedgrowthforVFINX,SSO,andUPRO
fig<-onemetric_graph(tickers=c("VFINX","SSO","UPRO"),
plot.list=list(ylim=c(0,50)))
##End(Notrun)
onemetric_overtime_graph
GraphPerformanceMetricOverTimeforVariousInvestments
Description
Usefulforvisualizingtheperformanceofagroupofinvestmentsovertime.Theinvestmentis
usedasthebenchmarkiftherequestedmetricrequiresone.
Usage
onemetric_overtime_graph(tickers=NULL,...,gains=NULL,prices=NULL,
y.metric="cagr",window.units=50,add.plot=FALSE,colors=NULL,
lty=NULL,plot.list=NULL,points.list=NULL,legend.list=NULL,
pdf.list=NULL,bmp.list=NULL,jpeg.list=NULL,png.list=NULL,
tiff.list=NULL)
*****page break******onemetric_overtime_graph
21
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
...
Argumentstopassalongwith
tickers
to
load_gains
.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
y.metric
Characterstringspecifyingy-axisperformancemetric.Choicesare:
"mean"
or
"sd"
formeanorstandarddeviationofgains.
"growth"
or
"cagr"
fortotalorannualizedgrowth.
"mdd"
formaximumdrawdown.
"sharpe"
or
"sortino"
forSharpeorSortinoratio.
"alpha"
,
"beta"
,or
"r.squared"
forthosemetricsfromalinearregres-
siononbenchmarkfund.
"pearson"
or
"spearman"
forPearsonorSpearmancorrelationwithbenchmark
fund.
"auto.pearson"
or
"auto.spearman"
forPearsonorSpearmanautocorrela-
tion,asthecorrelationbetweensubsequentgains.
window.units
Numericvaluespecifyingthewidthofthemovingwindow.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
colors
Charactervectorofcolorsforeachcurve.
lty
Numericvectorspecifyinglinetypesforeachcurve.
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
legend.list
Listofargumentstopassto
legend
.
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,anumericmatrixcontainingtheperformancemetricovertimeforeach
investment.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
*****page break******22
pchanges
Examples
##Notrun:
#PlotBRK-B
'
s50-dayalphaovertimesincethestartof2016
fig<-onemetric_overtime_graph(tickers=c("VFINX","BRK-B"),
y.metric="alpha",
from="2016-01-01")
##End(Notrun)
pchanges
LaggedProportionChanges
Description
Calculatesproportionchangesbetweensubsequent(orlagged)elementsofavector.
Usage
pchanges(x,lag=1L)
Arguments
x
Numericvector.
lag
Numericvalue(e.g.2fordifferencesbetween1stand3rdelement,2ndand4th,
...).
Value
Numericvector.
Examples
#Generate10valuesfromN(0,1)
x<-rnorm(10)
#Calculatevectorofproportionchangesbetweensubsequentvalues
(y<-pchanges(x))
#EquivalentbaseRcomputation
len<-length(x)
p1<-x[2:len]
p2<-x[1:(len-1)]
y2<-p1/p2-1
all.equal(y,y2)
*****page break******pdiffs
23
pdiffs
LaggedProportionDifferences
Description
Calculatesproportiondifferencesbetweensubsequent(orlagged)elementsofavector.
Usage
pdiffs(x,lag=1L)
Arguments
x
Numericvector.
lag
Numericvalue(e.g.2fordifferencesbetween1stand3rdelement,2ndand4th,
...).
Value
Numericvector.
Examples
#Generate10valuesfromN(0,1)
x<-rnorm(10)
#Calculatevectorofproportiondifferencesbetweensubsequentvalues
(y<-pdiffs(x))
#EquivalentbaseRcomputation
len<-length(x)
p1<-x[2:len]
p2<-x[1:(len-1)]
y2<-(p1-p2)/(0.5*(p1+p2))
all.equal(y,y2)
prices_gains
ConvertPricestoGains
Description
Calculatesgainsbasedonvectorormatrixofprices.
*****page break******24
prices_rate
Usage
prices_gains(prices)
Arguments
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
Value
Numericvectorormatrix.
Examples
##Notrun:
#Load2017pricesforNetflixandAmazon,andcalculategrowthof$10k
prices<-load_prices(c("NFLX","AMZN"),initial=1000)
#Calculategains
gains<-prices_gains(prices)
##End(Notrun)
prices_rate
CalculateGrowthRateFromaVectorofPrices
Description
Theformulaissimply:
prices[length(prices)]/prices[1]-1
.If
units.rate
is
thenitconvertstox-unitgrowthrate.
Usage
prices_rate(prices,units.rate=NULL)
Arguments
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
units.rate
Numericvaluespecifyingthenumberofunitsforgrowthratecalculation,ifyou
wantsomethingotherthantotalgrowth.Forannualizedgrowthrate,setto252
if
prices
hasdailyprices,12if
prices
hasmonthlyprices,etc.
Value
Numericvalueif
prices
isavector,numericmatrixif
prices
isamatrix.
*****page break******ratios
25
Examples
#Createvectorofdailyclosingpricesforahypotheticalstock
prices<-c(100.4,98.7,101.3,101.0,100.9)
#Overallgrowthis0.50%
prices_rate(prices)
#Averagedailygrowthis0.12%
prices_rate(prices,1)
#Correspondsto36.7%annualizedgrowth
prices_rate(prices,252)
ratios
RatiosofSubsequentElementsinaVector
Description
Calculatesvectorofratiosofavector,i.e.ratioof
x[2]
to
x[1]
,ratioof
x[3]
to
x[2]
,andsoforth.
Usage
ratios(x)
Arguments
x
Numericvector.
Value
Numericvector.
Examples
#Generate10valuesfromN(0,1)
x<-rnorm(10)
#Calculatevectorofratios
(y<-ratios(x))
#SlowerbaseRcomputation
len<-length(x)
y2<-x[2:len]/x[1:(len-1)]
all.equal(y,y2)
*****page break******26
rrr
rrr
Risk-ReturnRatio
Description
Calculatesrisk-returnratio,asgrowthratedividedbymaximumdrawdown.
Usage
rrr(prices=NULL,gains=NULL)
Arguments
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
Value
Numericvalueorvector.
Examples
#Simulatedailygainsovera5-yearperiod
set.seed(123)
stock.gains<-rnorm(252*5,0.0005,0.01)
#Converttodailybalancesassuminganinitialbalanceof$10,000
daily.balances<-gains_prices(stock.gains+1)
#Totalreturnisabout1.23
daily.balances[length(daily.balances)]/daily.balances[1]-1
#Maximumdrawdownisabout0.19
mdd(prices=daily.balances)
#Ratioofthesetwoisabout6.48
(daily.balances[length(daily.balances)]/daily.balances[1]-1)/
mdd(daily.balances)
#Easiertocalculateusingrrrfunction
rrr(daily.balances)
*****page break******sector_spdr_etfs
27
sector_spdr_etfs
SectorSPDRETFsandInceptionDates
Description
SectorSPDRETFsandInceptionDates
Source
http://www.sectorspdr.com/sectorspdr/sectors/performance
sharpe
SharpeRatio
Description
CalculatesSharperatiofromvectorofgainsorprices.Theformulais:
(mean(gains)-rf)/sd(gains)
,
where
rf
issomerisk-freerateofreturn.
Usage
sharpe(gains=NULL,prices=NULL,rf=0)
Arguments
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
rf
Numericvalue.
Value
Numericvalue.
Examples
#Simulatedailygainsovera5-yearperiod
set.seed(123)
stock.gains<-rnorm(252*5,0.0005,0.01)
#CalculateSharperatiousingrisk-freereturnof0
sharpe(stock.gains)
*****page break******28
stocks
sortino
SortinoRatio
Description
CalculatesSortinoratiofromvectorofgainsorprices.Theformulais:
(mean(gains)-rf)/sd(gains[gains<0])
,
where
rf
issomerisk-freerateofreturn.
Usage
sortino(gains=NULL,prices=NULL,rf=0)
Arguments
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
rf
Numericvalue.
Value
Numericvalueorvector.
Examples
#Simulatedailygainsovera5-yearperiod
set.seed(123)
stock.gains<-rnorm(252*5,0.0005,0.01)
#CalculateSortinoratiousingrisk-freereturnof0
sortino(stock.gains)
stocks
StockMarketAnalysis
Description
Functionsforanalyzingstocksorotherinvestments.Mainfeaturesareloadingandaligninghistor-
icaldatafortickersymbols,calculatingperformancemetricsforindividualfundsorportfolios(e.g.
annualizedgrowth,maximumdrawdown,Sharpe/Sortinoratio),andcreatinggraphs.C++codeis
usedtoimproveprocessingspeedwherepossible.
Details
*****page break******targetall
29
Package:stocks
Type:Package
Version:1.1.4
Date:2018-08-30
License:GPL-3
See
CRANdocumentation
forfulllistoffunctionsandthe
GitHubpage
foranoverviewofthe
packagewithsomeexamples.
Author(s)
DaneR.VanDomelen
<vandomed@gmail.com>
References
Eddelbuettel,D.andFrancois,R.(2011)Rcpp:SeamlessRandC++Integration.JournalofStatis-
ticalSoftware,40(8),1-18.
http://www.jstatsoft.org/v40/i08/
.
Eddelbuettel,D.(2013)SeamlessRandC++IntegrationwithRcpp.Springer,NewYork.ISBN
978-1-4614-6867-7.
Eddelbuettel,D.andBalamuta,J.J.(2017).ExtendingRwithC++:ABriefIntroductiontoRcpp.
PeerJPreprints5:e3188v1.
https://doi.org/10.7287/peerj.preprints.3188v1
.
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Acknowledgment:ThismaterialisbaseduponworksupportedbytheNationalScienceFoundation
GraduateResearchFellowshipunderGrantNo.DGE-0940903.
targetall
BacktestaFixed-AllocationTradingStrategy
Description
Implementsatradingstrategyaimedatmaintainingaedallocationtoeachofseveralfunds,
rebalancingwhentheeffectiveallocationsdeviatetoofarfromthetargets.
Usage
targetall(tickers=NULL,intercepts=NULL,slopes=NULL,...,
tickers.gains=NULL,target.alls=NULL,tol=0.05,
rebalance.cost=0,initial=10000)
*****page break******30
targetbeta_twofunds
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
intercepts
Numericvectorofvaluestoaddtodailygainsforeachticker.
slopes
Numericvectorofvaluestomultiplydailygainsforeachtickerby.Slopesare
multipliedpriortoaddingintercepts.
...
Argumentstopassalongwith
tickers
to
load_gains
.
tickers.gains
Numericmatrixofgains,whereeachcolumnhasgainsforaparticularfund.
target.alls
Numericvectorspecifyingtargetallocationstoeachfund.Ifequal
allocationsareused(e.g.1/3,1/3,1/3ifthereare3funds).
tol
Numericvalueindicatinghowfartheeffectiveallocationscandriftawayfrom
thetargetsbeforerebalancing.
rebalance.cost
Numericvaluespecifyingtotalcostofeachrebalancingtrade.
initial
Numericvaluespecifyingwhatvaluetoscaleinitialpricesto.
Value
Listcontaining:
1.
Numericmatrixnamed
fund.balances
givingfundbalancesovertime.
2.
Numericvaluenamed
rebalance.count
givingthenumberofrebalancingtradesexecuted.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#Backtestequal-allocationUPRO/VBLTX/VWEHXstrategy
port<-targetall(tickers=c("UPRO","VBLTX","VWEHX"))
plot(port$fund.balances[,"Portfolio"])
##End(Notrun)
targetbeta_twofunds
BacktestaTwo-FundStrategythatTargetsaCertainBeta
Description
Implementsatwo-fundstrategywhereallocationstoeachfundareadjustedtomaintainsome
userportfoliobeta.Forexample,youcouldback-testazero-beta(i.e.marketneutral)
UPRO/VBLTXstrategyusingthisfunction.
*****page break******targetbeta_twofunds
31
Usage
targetbeta_twofunds(tickers=NULL,intercepts=NULL,slopes=NULL,...,
benchmark.ticker=NULL,reference.tickers=NULL,tickers.gains=NULL,
benchmark.gains=NULL,reference.gains=NULL,target.beta=0,
tol=0.15,window.units=50,failure.method="closer",
maxall.tol=tol-0.05,initial=10000)
Arguments
tickers
Charactervectorspecifying2tickersymbolsthatYahoo!Financerecognizes,if
youwanttodownloaddataonthe.
intercepts
Numericvectorofvaluestoaddtodailygainsforeachticker.
slopes
Numericvectorofvaluestomultiplydailygainsforeachtickerby.Slopesare
multipliedpriortoaddingintercepts.
...
Argumentstopassalongwith
tickers
to
load_gains
.
benchmark.ticker
Characterstringspecifyingtickersymbolforbenchmarkindexforcalculating
beta.Ifthefundin
tickers
isusedasthebenchmark.
reference.tickers
Charactervectoroftickersymbolstoincludeongraphasdatapointsforcom-
parativepurposes.
tickers.gains
Numericmatrixofgains,whereeachcolumnhasgainsforaparticularfund.
benchmark.gains
Numericvectorofgainsforthebenchmarkindexforcalculatingbeta.Ifun-
thefundin
tickers.gains
isusedasthebenchmark.
reference.gains
Numericvectorormatrixofgainsforfundstoincludeongraphasdatapoints
forcomparativepurposes.
target.beta
Numericvalue.
tol
Numericvaluespecifyinghowfartheeffectiveportfoliobetahastodeviatefrom
target.beta
totriggerarebalancingtrade.
window.units
Numericvaluespecifyingthewidthofthetrailingmovingwindowusedtoesti-
mateeachfund'sbeta.
failure.method
Characterstringorvectorspecifyingmethod(s)tousewhenfundbetasaresuch
thatthetargetportfoliobetacannotbeachieved.Choicesare
"cash"
,
"fund1"
,
"fund2"
,
"fund1.maxall"
,
"fund2.maxall"
,
"inverse1"
,
"inverse2"
,and
"closer"
.SeeDetails.
maxall.tol
Numericvaluespecifyingtolerancetousewhenimplementingthe
"fund1.maxall"
or
"fund2.maxall"
failuremethod.Toillustrate,if
target.beta=0
,fund1
hasacurrentbetaof1,fund2hasacurrentbetaof0.25,
failure.method="fund2.maxall"
,
and
maxall.tol=0.1
,atradewillbetriggeredthatresultsin40%fund2and
60%cash.Theportfoliobetais
0.4*0.25=0.1
.Thereasonyoumightwant
maxall.tol
tobelessthan
tol
istoavoidfrequentlytriggeringanothertrade
ontheverynextday,asfund2'sbetachangesalittleandmovestheportfolio
betaoutsideof
[target.beta-tol,target.beta+tol]
.
initial
Numericvaluespecifyingwhatvaluetoscaleinitialpricesto.
*****page break******32
targetbeta_twofunds
Details
Thegeneralimplementationisasfollows.Betaforeachofthetwofundsisestimatedbasedonthe

window.units
gains.Initialallocationsareselectedtoachieveportfoliobetaof
target.beta
.
Ifthatisnotpossible-forexample,if
target.beta=0
andbothfundshavepositivebeta-then
theactiontakendependsonwhatmethodisselectedthroughthe
failure.method
input(details
below).
Assumingthetargetbetaisattainable,thefunctionmovesover1day,andapplieseachfund'sgains
forthatday.Itthenre-calculateseachfund'sbetabasedonthe
window.units
-widthinterval,and
determinestheeffectiveportfoliobetabasedonfundallocationsandbetas.Iftheeffectivebetais
outsideof
[target.beta-tol,target.beta+tol]
,arebalancingtradeistriggered.As
before,ifthetargetbetacannotbeachieved,certainactionsaretakendependingontheselected
method.
Whenoutsideofatradebecausethetargetbetacouldnotbeachieved,thefunctionattemptsto
rebalanceeachtimeitshiftsovertoanewday,regardlessoftheeffectiveportfoliobeta.
When
failure.method="cash"
,theentireportfoliobalanceisallocatedtocashwhenthetarget
betacannotbeachieved.
When
failure.method="fund1"
(or
"fund2"
),theentireportfoliobalanceisallocatedtothe
(orsecond)fundwhenthetargetbetacannotbeachieved.
When
failure.method="fund1.maxall"
(or
"fund2.maxall"
),whenthetargetbetacannotbe
achieved,fund1(orfund2)iscombinedwithcash,withthefund1(fund2)allocationashighas
possiblewhilestayingwithin
maxall.tol
of
target.beta
.
When
failure.method="inverse1"
(or
"inverse2"
),aninverseversionofthe(orsecond)
fundisusedwhenthetargetbetacannotbeachieved.Inmanycaseswherethetargetbetacannot
beachievedwiththetwofunds,itcanbeachievedwithaninverseversionofoneandtheother.If
thetargetbetastillcannotbeachieved,theentireportfoliobalanceisallocatedtocash.
When
failure.method="closer"
,theentireportfoliobalanceisallocatedtowhicheverfund
hasabetacloserto
target.beta
.
Value
Foreachmethod,a4-elementlistcontaining:
1.
Numericmatrixnamed
fund.balances
givingfundbalancesovertime.
2.
Numericmatrixnamed
fund.betas
givingfundbetasovertime.
3.
Numericvectornamed
effective.betas
givingeffectiveportfoliobetaovertime.
4.
Numericvaluenamed
trades
givingthetotalnumberoftradesexecuted.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
*****page break******threefunds_graph
33
Examples
##Notrun:
#Backtestzero-betaUPRO/VBLTXstrategy
beta0<-targetbeta_twofunds(tickers=c("UPRO","VBLTX"),target.beta=0)
plot(beta0$fund.balances[,"Portfolio"])
##End(Notrun)
threefunds_graph
GraphOnePerformanceMetricvs.AnotherforThree-FundPortfolio
asAllocationVaries
Description
Usefulforvisualizingperformanceofthree-fundportfolios,typicallybyplottingameasureof
growthvs.ameasureofvolatility.Onlyworksforonethree-fundsetatatime.
Usage
threefunds_graph(tickers=NULL,intercepts=NULL,slopes=NULL,...,
benchmark.tickers=NULL,reference.tickers=NULL,
tickers.gains=NULL,benchmark.gains=NULL,reference.gains=NULL,
step.data=0.0025,step.points=0.1,step.curves=0.2,
x.metric="sd",y.metric="mean",tickerlabel.offsets=NULL,
reflabel.offsets=NULL,add.plot=FALSE,colors=NULL,lty=NULL,
plot.list=NULL,points.list=NULL,text.list=NULL,
pdf.list=NULL,bmp.list=NULL,jpeg.list=NULL,png.list=NULL,
tiff.list=NULL)
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
intercepts
Numericvectorofvaluestoaddtodailygainsforeachticker.
slopes
Numericvectorofvaluestomultiplydailygainsforeachtickerby.Slopesare
multipliedpriortoaddingintercepts.
...
Argumentstopassalongwith
tickers
to
load_gains
.
benchmark.tickers
Charactervectoroflength1or2indicatingtickersymbolsforbenchmarkin-
dexes.Onlyusedif
x.metric
and/or
y.metric
requirebenchmarkindexesto
calculate.Forexample,toplotcorrelationwithSPYonthex-axisandcorrela-
tionwithTLTonthey-axis,set
x.metric="pearson"
,
y.metric="pearson2"
(i.e.Pearsoncorrelationwith2ndbenchmark),and
benchmark.tickers=c("SPY","TLT")
.
reference.tickers
Charactervectoroftickersymbolstoincludeongraphasdatapointsforcom-
parativepurposes.
*****page break******34
threefunds_graph
tickers.gains
Numericmatrixofgains,whereeachcolumnhasgainsforaparticularfund.
benchmark.gains
Numericvectorormatrixofgainsfor1or2benchmarkindexes.Onlyusedif
x.metric
and/or
y.metric
requirebenchmarkindexestocalculate.Forexam-
ple,toplotcorrelationwithSPYonthex-axisandcorrelationwithTLTonthe
y-axis,set
x.metric="pearson"
and
y.metric="pearson2"
,andinput
benchmark.gains
asa2-columnmatrixofgainsforSPYandTLT.
reference.gains
Numericvectorormatrixofgainsforfundstoincludeongraphasdatapoints
forcomparativepurposes.
step.data
Numericvaluespecifyingallocationincrementsforplottingcurves.
step.points
Numericvaluespecifyingallocationincrementsforaddingdatapointsontopof
curves.Setto
NULL
tosuppressdatapoints.
step.curves
Numericvaluespecifyingallocationincrementsforfundineachset.
x.metric
Characterstringspecifyingx-axisperformancemetric.Choicesare:
"mean"
or
"sd"
formeanorstandarddeviationofgains
"growth"
or
"cagr"
fortotalorannualizedgrowth
"mdd"
formaximumdrawdown
"sharpe"
or
"sortino"
forSharpeorSortinoratio
"alpha"
,
"beta"
,or
"r.squared"
forthosemetricsfromalinearregres-
siononbenchmarkfund
"pearson"
or
"spearman"
forPearsonorSpearmancorrelationwithbenchmark
fund
"alpha2"
,
"beta2"
,
"r.squared2"
,
"pearson2"
,or
"spearman2"
forsameas
previouslydescribed,butusingthesecondbenchmarkindex
"auto.pearson"
or
"auto.spearman"
forPearsonorSpearmanautocorrela-
tion,asthecorrelationbetweensubsequentgains
"allocation"
forallocationtofundineachpair.
y.metric
Sameas
x.metric
,butforthey-axis
tickerlabel.offsets
Eitheranumericvectoroflength2givingthex-andy-axisoffsetsforallticker
labels,ora2-columnmatrixwhereeachrowgivesthex-andy-axisoffsetsfor
aticker.
reflabel.offsets
Eitheranumericvectoroflength2givingthex-andy-axisoffsetsforallrefer-
encetickerlabels,ora2-columnmatrixwhereeachrowgivesthex-andy-axis
offsetsforareferenceticker.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
colors
Charactervectorofcolorsforeachcurve.
lty
Numericvectorspecifyinglinetypesforeachcurve.
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
*****page break******ticker_dates
35
text.list
Listofargumentstopassto
text
.
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,alistcontaining:
1.
Listnamed
portfolio.xy
whereeachelementisatwo-columnmatrixofx-andy-axisvalues
foracurve.
2.
Numericvectornamed
means
withmeangainsforeachfund.
3.
Numericmatrixnamed
corr.matrix
withacorrelationmatrixforgainsforeachfund.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#Plotmeanvs.SDforUPRO/VBLTX/VWEHXportfolio,andcomparetoVFINXand
#BRK-B
fig<-threefunds_graph(tickers=c("VWEHX","VBLTX","UPRO"),
reference.tickers=c("VFINX","BRK-B"))
##End(Notrun)
ticker_dates
GetYahoo!FinanceStart/EndDatesforTickers
Description
Typicallyusefulfordeterminingatimeperiodoverwhichtocompareseveralfunds.
Usage
ticker_dates(tickers,from="1950-01-01",to=Sys.Date())
*****page break******36
twofunds_graph
Arguments
tickers
CharactervectorwithtickersymbolsthatYahoo!Financerecognizes.
from
Dateorcharacterstring(e.g.
"2015-01-15"
.
to
Dateorcharacterstring(e.g.
"2016-01-30"
).
Value
Dataframewithtickersymbol,startdate,enddate,andnumberoftradingdaysforeachticker.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#SeewhatdatesareavailableforAppleandAmazon
ticker_dates(c("AAPL","AMZN"))
##End(Notrun)
twofunds_graph
GraphOnePerformanceMetricvs.AnotherforTwo-FundPortfolios
asAllocationVaries
Description
Usefulforvisualizingperformanceoftwo-fundportfolios,typicallybyplottingameasureofgrowth
vs.ameasureofvolatility.Firsttwoinvestmentsareusedasthetwo-fundpair,nexttwoasthe
secondtwo-fundpair,andsoon.
Usage
twofunds_graph(tickers=NULL,intercepts=NULL,slopes=NULL,...,
benchmark.tickers=NULL,reference.tickers=NULL,
tickers.gains=NULL,benchmark.gains=NULL,reference.gains=NULL,
step.data=0.0025,step.points=0.1,x.metric="sd",
y.metric="mean",tickerlabel.offsets=NULL,reflabel.offsets=NULL,
add.plot=FALSE,colors=NULL,lty=NULL,plot.list=NULL,
points.list=NULL,text.list=NULL,pdf.list=NULL,
bmp.list=NULL,jpeg.list=NULL,png.list=NULL,tiff.list=NULL)
*****page break******twofunds_graph
37
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
intercepts
Numericvectorofvaluestoaddtodailygainsforeachticker.
slopes
Numericvectorofvaluestomultiplydailygainsforeachtickerby.Slopesare
multipliedpriortoaddingintercepts.
...
Argumentstopassalongwith
tickers
to
load_gains
.
benchmark.tickers
Charactervectoroflength1or2indicatingtickersymbolsforbenchmarkin-
dexes.Onlyusedif
x.metric
and/or
y.metric
requirebenchmarkindexesto
calculate.Forexample,toplotcorrelationwithSPYonthex-axisandcorrela-
tionwithTLTonthey-axis,set
x.metric="pearson"
,
y.metric="pearson2"
(i.e.Pearsoncorrelationwith2ndbenchmark),and
benchmark.tickers=c("SPY","TLT")
.
reference.tickers
Charactervectoroftickersymbolstoincludeongraphasdatapointsforcom-
parativepurposes.
tickers.gains
Numericmatrixofgains,whereeachcolumnhasgainsforaparticularfund.
benchmark.gains
Numericvectorormatrixofgainsfor1or2benchmarkindexes.Onlyusedif
x.metric
and/or
y.metric
requirebenchmarkindexestocalculate.Forexam-
ple,toplotcorrelationwithSPYonthex-axisandcorrelationwithTLTonthe
y-axis,set
x.metric="pearson"
and
y.metric="pearson2"
,andinput
benchmark.gains
asa2-columnmatrixofgainsforSPYandTLT.
reference.gains
Numericvectorormatrixofgainsforfundstoincludeongraphasdatapoints
forcomparativepurposes.
step.data
Numericvaluespecifyingallocationincrementsforplottingcurves.
step.points
Numericvaluespecifyingallocationincrementsforaddingdatapointsontopof
curves.Setto
NULL
tosuppressdatapoints.
x.metric
Characterstringspecifyingx-axisperformancemetric.Choicesare:
"mean"
or
"sd"
formeanorstandarddeviationofgains
"growth"
or
"cagr"
fortotalorannualizedgrowth
"mdd"
formaximumdrawdown
"sharpe"
or
"sortino"
forSharpeorSortinoratio
"alpha"
,
"beta"
,or
"r.squared"
forthosemetricsfromalinearregres-
siononbenchmarkfund
"pearson"
or
"spearman"
forPearsonorSpearmancorrelationwithbenchmark
fund
"alpha2"
,
"beta2"
,
"r.squared2"
,
"pearson2"
,or
"spearman2"
forsameas
previouslydescribed,butusingthesecondbenchmarkindex
"auto.pearson"
or
"auto.spearman"
forPearsonorSpearmanautocorrela-
tion,asthecorrelationbetweensubsequentgains
"allocation"
forallocationtofundineachpair.
*****page break******38
twofunds_graph
y.metric
Sameas
x.metric
,butforthey-axis
tickerlabel.offsets
Eitheranumericvectoroflength2givingthex-andy-axisoffsetsforallticker
labels,ora2-columnmatrixwhereeachrowgivesthex-andy-axisoffsetsfor
aticker.
reflabel.offsets
Eitheranumericvectoroflength2givingthex-andy-axisoffsetsforallrefer-
encetickerlabels,ora2-columnmatrixwhereeachrowgivesthex-andy-axis
offsetsforareferenceticker.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
colors
Charactervectorofcolorsforeachcurve.
lty
Numericvectorspecifyinglinetypesforeachcurve.
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
text.list
Listofargumentstopassto
text
.
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,alistcontaining:
1.
Listnamed
portfolio.xy
whereeachelementisatwo-columnmatrixofx-andy-axisvalues
forafundpair.
2.
Numericvectornamed
means
withmeangainsforeachfund.
3.
Numericmatrixnamed
corr.matrix
withacorrelationmatrixforgainsforeachfund.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#Plotmeanvs.SDforUPRO/VBLTXportfolio,andcomparetoVFINXandBRK-B
fig1<-twofunds_graph(tickers=c("UPRO","VBLTX"),
reference.tickers=c("VFINX","BRK-B"))
#Samefunds,butannualizedgrowthvs.maximumdrawdown
fig2<-twofunds_graph(tickers=c("UPRO","VBLTX"),
reference.tickers=c("VFINX","BRK-B"),
*****page break******twometrics_graph
39
x.metric="mdd",y.metric="cagr")
##End(Notrun)
twometrics_graph
GraphOnePerformanceMetricvs.AnotherforVariousInvestments
Description
Usefulforvisualizingtheperformanceofagroupofinvestments.Theinvestmentisusedas
thebenchmarkif
x.metric
or
y.metric
requireonebenchmark,andthetwoinvestmentsare
usedasbenchmarksif
x.metric
and
y.metric
requiredifferentbenchmarks.
Usage
twometrics_graph(tickers=NULL,...,gains=NULL,prices=NULL,
x.metric="mdd",y.metric="cagr",tickerlabel.offsets=NULL,
add.plot=FALSE,colors=NULL,plot.list=NULL,points.list=NULL,
text.list=NULL,pdf.list=NULL,bmp.list=NULL,jpeg.list=NULL,
png.list=NULL,tiff.list=NULL)
Arguments
tickers
CharactervectoroftickersymbolsthatYahoo!Financerecognizes,ifyouwant
todownloaddataonthe.
...
Argumentstopassalongwith
tickers
to
load_gains
.
gains
Numericmatrixwith1columnofgainsforeachinvestment(canbeavectorif
thereisonlyone).
prices
Numericmatrixwith1columnofpricesforeachinvestment(canbeavectorif
thereisonlyone).
x.metric
Characterstringspecifyingx-axisperformancemetric.Choicesare:
"mean"
or
"sd"
formeanorstandarddeviationofgains.
"growth"
or
"cagr"
fortotalorannualizedgrowth.
"mdd"
formaximumdrawdown.
"sharpe"
or
"sortino"
forSharpeorSortinoratio.
"alpha"
,
"beta"
,or
"r.squared"
forthosemetricsfromalinearregres-
siononbenchmarkfund.
"pearson"
or
"spearman"
forPearsonorSpearmancorrelationwithbenchmark
fund.
"alpha2"
,
"beta2"
,
"r.squared2"
,
"pearson2"
,or
"spearman2"
forsameas
previouslydescribed,butusingthesecondbenchmarkindex.
"auto.pearson"
or
"auto.spearman"
forPearsonorSpearmanautocorrela-
tion,asthecorrelationbetweensubsequentgains.
y.metric
Sameas
x.metric
,butforthey-axis.
*****page break******40
vanguard_balanced_funds
tickerlabel.offsets
Eitheranumericvectoroflength2givingthex-andy-axisoffsetsforallticker
labels,ora2-columnmatrixwhereeachrowgivesthex-andy-axisoffsetsfor
aticker.
add.plot
Logicalvalueforwhethertoaddplotdatatocurrentplotframeratherthanopen
anewone.
colors
Charactervectorofcolorsforeachcurve.
plot.list
Listofargumentstopassto
plot
.
points.list
Listofargumentstopassto
points
.
text.list
Listofargumentstopassto
text
.
pdf.list
Listofargumentstopassto
pdf
.
bmp.list
Listofargumentstopassto
bmp
.
jpeg.list
Listofargumentstopassto
jpeg
.
png.list
Listofargumentstopassto
png
.
tiff.list
Listofargumentstopassto
tiff
.
Value
Inadditiontothegraph,adataframecontainingtheperformancemetricsforeachinvestment.
References
Ryan,J.A.andUlrich,J.M.(2017)quantmod:QuantitativeFinancialModellingFramework.R
packageversion0.4-12,
https://CRAN.R-project.org/package=quantmod
.
Examples
##Notrun:
#Plotannualizedgrowthvs.maximumdrawdownforVFINX,SSO,andUPRO
fig<-twometrics_graph(tickers=c("VFINX","SSO","UPRO"))
##End(Notrun)
vanguard_balanced_funds
VanguardBalancedMutualFundsandInceptionDates
Description
VanguardBalancedMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
*****page break******vanguard_bond_etfs
41
vanguard_bond_etfs
VanguardBondETFsandInceptionDates
Description
VanguardBondETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_bond_funds
VanguardBondMutualFunds
Description
VanguardBondMutualFunds
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_etfs
VanguardETFsandInceptionDates
Description
VanguardETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_funds
VanguardMutualFundsandInceptionDates
Description
VanguardMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
*****page break******42
vanguard_international_etfs
vanguard_igrade_etfs
VanguardInvestment-gradeBondETFsandInceptionDates
Description
VanguardInvestment-gradeBondETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_igrade_funds
VanguardInvestment-gradeBondMutualFundsandInceptionDates
Description
VanguardInvestment-gradeBondMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_international_etfs
VanguardInternationalETFsandInceptionDates
Description
VanguardInternationalETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
*****page break******vanguard_international_funds
43
vanguard_international_funds
VanguardInternationalMutualFundsandInceptionDates
Description
VanguardInternationalMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_largecap_etfs
VanguardLarge-capStockETFsandInceptionDates
Description
VanguardLarge-capStockETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_largecap_funds
VanguardLarge-capStockMutualFundsandInceptionDates
Description
VanguardLarge-capStockMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
*****page break******44
vanguard_sector_funds
vanguard_midcap_etfs
VanguardMid-capStockETFsandInceptionDates
Description
VanguardMid-capStockETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_midcap_funds
VanguardMid-capStockMutualFundsandInceptionDates
Description
VanguardMid-capStockMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_sector_etfs
VanguardSector&SpecialtyETFsandInceptionDates
Description
VanguardSector&SpecialtyETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_sector_funds
VanguardSectorMutualFundsandInceptionDates
Description
VanguardSectorMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
*****page break******vanguard_smallcap_etfs
45
vanguard_smallcap_etfs
VanguardSmall-capStockETFsandInceptionDates
Description
VanguardSmall-capStockETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_smallcap_funds
VanguardSmall-capStockMutualFundsandInceptionDates
Description
VanguardSmall-capStockMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_stock_etfs
VanguardStockETFsandInceptionDates
Description
VanguardStockETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
*****page break******46
vanguard_targetrisk_funds
vanguard_stock_funds
VanguardStockMutualFundsandInceptionDates
Description
VanguardStockMutualFundsandInceptionDates
Source
https://investor.vanguard.com/mutual-funds/list?assetclass=bond#/mutual-funds/asset-class/
month-end-returns
vanguard_targetdate_funds
VanguardTargetDateMutualFunds
Description
VanguardTargetDateMutualFunds
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_targetrisk_funds
VanguardTargetRiskMutualFundsandInceptionDates
Description
VanguardTargetRiskMutualFundsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
*****page break******vanguard_taxexempt_bond_funds
47
vanguard_taxexempt_bond_funds
VanguardTax-exemptBondMutualFundsandInceptionDates
Description
VanguardTax-exemptBondMutualFundsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_traditional_funds
VanguardTraditionalMutualFundsandInceptionDates
Description
VanguardTraditionalMutualFundsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
vanguard_treasury_etfs
VanguardTreasury/AgencyBondETFsandInceptionDates
Description
VanguardTreasury/AgencyBondETFsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
*****page break******48
vanguard_treasury_funds
vanguard_treasury_funds
VanguardTreasury/AgencyBondMutualFundsandInceptionDates
Description
VanguardTreasury/AgencyBondMutualFundsandInceptionDates
Source
https://investor.vanguard.com/etf/list?assetclass=bond#/etf/asset-class/month-end-returns
*****page break******Index
axis
,
19
beta_trailing50
,
3
bmp
,
10
,
13
,
20
,
21
,
35
,
38
,
40
contango_hedged
,
4
contango_simple
,
5
convert_gain
,
7
daily_yearly
,
8
diff
,
8
diffs
,
8
gains_graph
,
9
gains_prices
,
10
gains_rate
,
11
grid
,
13
growth_graph
,
12
highyield_etfs
,
13
jpeg
,
10
,
13
,
20
,
21
,
35
,
38
,
40
largest_etfs
,
14
legend
,
10
,
13
,
21
lm
,
10
load_gains
,
3
,
5
,
6
,
9
,
12
,
14
,
18
,
19
,
21
,
30
,
31
,
33
,
37
,
39
load_prices
,
15
mdd
,
17
metrics
,
18
onemetric_graph
,
19
onemetric_overtime_graph
,
20
pchanges
,
22
pdf
,
10
,
13
,
20
,
21
,
35
,
38
,
40
pdiffs
,
23
plot
,
10
,
13
,
19
,
21
,
34
,
38
,
40
png
,
10
,
13
,
20
,
21
,
35
,
38
,
40
points
,
10
,
13
,
19
,
21
,
34
,
38
,
40
prices_gains
,
23
prices_rate
,
24
ratios
,
25
rrr
,
26
sector_spdr_etfs
,
27
sharpe
,
27
sortino
,
28
stocks
,
28
stocks-package
(
stocks
)
,
28
targetall
,
29
targetbeta_twofunds
,
30
text
,
35
,
38
,
40
threefunds_graph
,
33
ticker_dates
,
35
tiff
,
10
,
13
,
20
,
21
,
35
,
38
,
40
twofunds_graph
,
36
twometrics_graph
,
39
vanguard_balanced_funds
,
40
vanguard_bond_etfs
,
41
vanguard_bond_funds
,
41
vanguard_etfs
,
41
vanguard_funds
,
41
vanguard_igrade_etfs
,
42
vanguard_igrade_funds
,
42
vanguard_international_etfs
,
42
vanguard_international_funds
,
43
vanguard_largecap_etfs
,
43
vanguard_largecap_funds
,
43
vanguard_midcap_etfs
,
44
vanguard_midcap_funds
,
44
vanguard_sector_etfs
,
44
vanguard_sector_funds
,
44
vanguard_smallcap_etfs
,
45
vanguard_smallcap_funds
,
45
vanguard_stock_etfs
,
45
49
*****page break******50
INDEX
vanguard_stock_funds
,
46
vanguard_targetdate_funds
,
46
vanguard_targetrisk_funds
,
46
vanguard_taxexempt_bond_funds
,
47
vanguard_traditional_funds
,
47
vanguard_treasury_etfs
,
47
vanguard_treasury_funds
,
48
*****page break******